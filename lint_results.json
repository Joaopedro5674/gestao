[{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\public\\sw.js","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CACHE_NAME' is assigned a value but never used.","line":2,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'event' is defined but never used.","line":4,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'event' is defined but never used.","line":14,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":38}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst CACHE_NAME = 'gestao-pwa-v1';\r\n\r\nself.addEventListener('install', (event) => {\r\n    // Force waiting service worker to become active immediately\r\n    self.skipWaiting();\r\n});\r\n\r\nself.addEventListener('activate', (event) => {\r\n    // Claim clients immediately to control the page as soon as possible\r\n    event.waitUntil(self.clients.claim());\r\n});\r\n\r\nself.addEventListener('fetch', (event) => {\r\n    // NETWORK ONLY STRATEGY\r\n    // We intentionally do NOT cache anything to avoid issues with Supabase/API.\r\n    // The mere presence of this fetch handler satisfies PWA installability criteria.\r\n    return;\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\api\\cron\\keep-alive\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\api\\keep-alive\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\auth\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":6,"column":47,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":58}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabaseClient\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { Lock, Mail, ArrowRight, CheckCircle, AlertCircle, Loader2 } from \"lucide-react\";\r\nimport { useToast } from \"@/components/ToastProvider\";\r\n\r\nexport default function AuthPage() {\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [isSignUp, setIsSignUp] = useState(false); // Toggle between Login/Register\r\n    const router = useRouter();\r\n    const { showToast } = useToast();\r\n\r\n    const handleAuth = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n\r\n        try {\r\n            if (isSignUp) {\r\n                const { error } = await supabase.auth.signUp({\r\n                    email,\r\n                    password,\r\n                });\r\n                if (error) throw error;\r\n                showToast(\"Conta criada! Verifique seu email.\", \"success\");\r\n            } else {\r\n                const { error } = await supabase.auth.signInWithPassword({\r\n                    email,\r\n                    password,\r\n                });\r\n                if (error) throw error;\r\n                showToast(\"Login realizado com sucesso!\", \"success\");\r\n                router.push(\"/\");\r\n            }\r\n        } catch (error) {\r\n            showToast((error as { message?: string }).message || \"Erro na autenticação\", \"error\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{\r\n            minHeight: '100vh',\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            justifyContent: 'center',\r\n            alignItems: 'center',\r\n            padding: '24px',\r\n            background: '#F7F8FA'\r\n        }}>\r\n            <div className=\"card\" style={{\r\n                width: '100%',\r\n                maxWidth: '420px',\r\n                padding: '40px',\r\n                boxShadow: '0 4px 20px rgba(0, 0, 0, 0.05)',\r\n                border: '1px solid #E5E7EB',\r\n                background: '#FFFFFF',\r\n                borderRadius: '16px'\r\n            }}>\r\n                {/* Header */}\r\n                <div style={{ textAlign: 'center', marginBottom: '32px' }}>\r\n                    <div style={{\r\n                        width: '64px', height: '64px', background: '#2563EB', borderRadius: '16px',\r\n                        display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 16px',\r\n                        boxShadow: '0 10px 15px -3px rgba(37, 99, 235, 0.2)'\r\n                    }}>\r\n                        <Lock color=\"white\" size={32} />\r\n                    </div>\r\n                    <h1 style={{ fontSize: '1.75rem', fontWeight: '800', color: '#1F2937', letterSpacing: '-0.025em' }}>\r\n                        {isSignUp ? \"Criar Conta\" : \"Bem-vindo\"}\r\n                    </h1>\r\n                    <p style={{ color: '#6B7280', fontSize: '1rem', marginTop: '8px' }}>\r\n                        {isSignUp ? \"Registre-se para começar\" : \"Gerencie seu patrimônio com facilidade\"}\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Form */}\r\n                <form onSubmit={handleAuth}>\r\n                    <div className=\"form-group\" style={{ marginBottom: '20px' }}>\r\n                        <label className=\"label\" style={{ display: 'flex', gap: '8px', alignItems: 'center', color: '#4B5563', fontWeight: '600', marginBottom: '8px' }}>\r\n                            <Mail size={16} color=\"#6B7280\" /> Email\r\n                        </label>\r\n                        <input\r\n                            type=\"email\"\r\n                            className=\"input\"\r\n                            value={email}\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            required\r\n                            placeholder=\"seu@email.com\"\r\n                            style={{\r\n                                padding: '12px 16px',\r\n                                background: '#F9FAFB',\r\n                                border: '1px solid #D1D5DB',\r\n                                borderRadius: '10px',\r\n                                fontSize: '1rem',\r\n                                color: '#1F2937'\r\n                            }}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\" style={{ marginBottom: '28px' }}>\r\n                        <label className=\"label\" style={{ display: 'flex', gap: '8px', alignItems: 'center', color: '#4B5563', fontWeight: '600', marginBottom: '8px' }}>\r\n                            <Lock size={16} color=\"#6B7280\" /> Senha\r\n                        </label>\r\n                        <input\r\n                            type=\"password\"\r\n                            className=\"input\"\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            required\r\n                            placeholder=\"••••••\"\r\n                            minLength={6}\r\n                            style={{\r\n                                padding: '12px 16px',\r\n                                background: '#F9FAFB',\r\n                                border: '1px solid #D1D5DB',\r\n                                borderRadius: '10px',\r\n                                fontSize: '1rem',\r\n                                color: '#1F2937'\r\n                            }}\r\n                        />\r\n                    </div>\r\n\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"btn btn-full\"\r\n                        disabled={loading}\r\n                        style={{\r\n                            height: '52px',\r\n                            fontSize: '1rem',\r\n                            fontWeight: '700',\r\n                            justifyContent: 'center',\r\n                            background: '#2563EB',\r\n                            color: 'white',\r\n                            borderRadius: '10px',\r\n                            transition: 'all 0.2s ease',\r\n                            border: 'none',\r\n                            cursor: loading ? 'not-allowed' : 'pointer',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            gap: '8px'\r\n                        }}\r\n                    >\r\n                        {loading ? <Loader2 className=\"spin-anim\" /> : (\r\n                            <>\r\n                                {isSignUp ? \"Registrar\" : \"Entrar\"} <ArrowRight size={18} />\r\n                            </>\r\n                        )}\r\n                    </button>\r\n                </form>\r\n\r\n                {/* Footer / Toggle */}\r\n                <div style={{ textAlign: 'center', marginTop: '28px', paddingTop: '20px', borderTop: '1px solid #F3F4F6' }}>\r\n                    <p style={{ fontSize: '0.9rem', color: '#6B7280' }}>\r\n                        {isSignUp ? \"Já tem uma conta?\" : \"Não tem conta?\"}\r\n                        <button\r\n                            onClick={() => setIsSignUp(!isSignUp)}\r\n                            style={{\r\n                                background: 'none', border: 'none', color: '#2563EB',\r\n                                fontWeight: '700', cursor: 'pointer', marginLeft: '6px'\r\n                            }}\r\n                        >\r\n                            {isSignUp ? \"Fazer Login\" : \"Criar agora\"}\r\n                        </button>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Safe badge */}\r\n            <div style={{ marginTop: '32px', display: 'flex', gap: '8px', alignItems: 'center', opacity: 0.8 }}>\r\n                <CheckCircle size={14} color=\"#10B981\" />\r\n                <span style={{ fontSize: '0.85rem', fontWeight: '600', color: '#6B7280' }}>Ambiente Criptografado e Seguro</span>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\[id]\\edit\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onDelete' is defined but never used.","line":88,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":98,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, use } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { ChevronLeft, Trash2, Save, User, DollarSign, Percent, Calendar, Phone } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Emprestimo } from \"@/types\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function EditLoanPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n    const router = useRouter();\r\n    const { emprestimos, atualizarEmprestimo, deletarEmprestimo } = useApp();\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const loan = emprestimos.find((l) => l.id === id) || null;\r\n\r\n    if (!loan) {\r\n        return (\r\n            <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>\r\n                <p>Carregando empréstimo...</p>\r\n                <Link href=\"/loans\" className=\"btn\" style={{ marginTop: '16px' }}>Voltar</Link>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (loan.status === 'pago') {\r\n        return (\r\n            <div className=\"container\">\r\n                <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-lg)', gap: 'var(--space-sm)' }}>\r\n                    <Link href={`/loans/${id}`} style={{ padding: '8px', marginLeft: '-8px' }}>\r\n                        <ChevronLeft size={24} />\r\n                    </Link>\r\n                    <h1 style={{ marginTop: '-4px' }}>Empréstimo Encerrado</h1>\r\n                </header>\r\n                <div className=\"card shadow-sm\" style={{ textAlign: 'center', padding: 'var(--space-xl)' }}>\r\n                    <p style={{ color: 'var(--color-text-secondary)', marginBottom: 'var(--space-lg)' }}>\r\n                        Este empréstimo já foi marcado como PAGO e não pode ser editado.\r\n                    </p>\r\n                    <Link href={`/loans/${id}`} className=\"btn btn-full\">Visualizar Detalhes</Link>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main style={{ minHeight: '100vh', background: 'var(--color-background)', padding: 'var(--space-md) 0' }}>\r\n            <div className=\"container\" style={{ maxWidth: '800px' }}>\r\n                <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-xl)', gap: 'var(--space-sm)' }}>\r\n                    <Link href={`/loans/${id}`} style={{\r\n                        padding: '10px',\r\n                        marginLeft: '-10px',\r\n                        color: 'var(--color-text-secondary)',\r\n                        transition: 'color 0.2s'\r\n                    }} className=\"hover-primary\">\r\n                        <ChevronLeft size={24} />\r\n                    </Link>\r\n                    <h1 style={{ fontSize: '1.75rem', fontWeight: 800, letterSpacing: '-0.03em' }}>Editar Empréstimo</h1>\r\n                </header>\r\n\r\n                <LoanEditForm\r\n                    loan={loan}\r\n                    onSubmit={atualizarEmprestimo}\r\n                    onDelete={deletarEmprestimo}\r\n                    onDeleteRequest={() => setIsDeleteModalOpen(true)}\r\n                    onSuccess={() => router.push(`/loans/${id}`)}\r\n                />\r\n\r\n                <DeleteConfirmModal\r\n                    isOpen={isDeleteModalOpen}\r\n                    onClose={() => setIsDeleteModalOpen(false)}\r\n                    onConfirm={async () => {\r\n                        await deletarEmprestimo(loan.id);\r\n                        router.push(\"/loans\");\r\n                    }}\r\n                    itemName={loan.cliente_nome}\r\n                    itemType=\"Empréstimo\"\r\n                />\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n\r\nfunction LoanEditForm({\r\n    loan,\r\n    onSubmit,\r\n    onDelete,\r\n    onSuccess,\r\n    onDeleteRequest\r\n}: {\r\n    loan: Emprestimo,\r\n    onSubmit: (id: string, updates: Partial<Emprestimo>) => Promise<void>,\r\n    onDelete: (id: string) => Promise<void>,\r\n    onSuccess: () => void,\r\n    onDeleteRequest: () => void\r\n}) {\r\n    const router = useRouter();\r\n    const [formData, setFormData] = useState({\r\n        borrowerName: loan.cliente_nome,\r\n        principal: loan.valor_emprestado.toString().replace('.', ','),\r\n        interestRate: loan.juros_mensal.toString().replace('.', ','),\r\n        phone: loan.telefone || \"\",\r\n        startDate: loan.data_inicio,\r\n        dueDate: loan.data_fim\r\n    });\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        await onSubmit(loan.id, {\r\n            cliente_nome: formData.borrowerName,\r\n            valor_emprestado: parseFloat(formData.principal.replace(',', '.')),\r\n            juros_mensal: parseFloat(formData.interestRate.replace(',', '.')),\r\n            telefone: formData.phone,\r\n            data_inicio: formData.startDate,\r\n            data_fim: formData.dueDate\r\n        });\r\n        onSuccess();\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-lg)' }}>\r\n\r\n            {/* Seção 1: Dados do Tomador */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <User size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Dados do Tomador</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Nome Completo</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.borrowerName}\r\n                            onChange={(e) => setFormData({ ...formData, borrowerName: e.target.value })}\r\n                            placeholder=\"Nome do cliente\"\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">\r\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                <Phone size={12} /> Telefone\r\n                            </div>\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.phone}\r\n                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                            placeholder=\"(00) 00000-0000\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Seção 2: Detalhes do Empréstimo */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <DollarSign size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Condições Financeiras</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: 'var(--space-lg)' }}>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">Valor Emprestado</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"input\"\r\n                                style={{ fontSize: '1.25rem', fontWeight: 700, color: 'var(--color-primary)' }}\r\n                                value={formData.principal}\r\n                                onChange={(e) => setFormData({ ...formData, principal: e.target.value })}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Percent size={12} /> Taxa Mensal\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"input\"\r\n                                value={formData.interestRate}\r\n                                onChange={(e) => setFormData({ ...formData, interestRate: e.target.value })}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Calendar size={12} /> Data de Início\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"input\"\r\n                                value={formData.startDate}\r\n                                onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Calendar size={12} /> Data de Vencimento\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"input\"\r\n                                value={formData.dueDate}\r\n                                onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Ações */}\r\n            <div style={{ marginTop: 'var(--space-lg)', display: 'flex', flexDirection: 'column', gap: 'var(--space-md)' }}>\r\n                <button type=\"submit\" className=\"btn btn-success\" style={{ height: '56px', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)' }}>\r\n                    <Save size={20} style={{ marginRight: '10px' }} />\r\n                    <span style={{ fontWeight: 700 }}>Salvar Alterações</span>\r\n                </button>\r\n\r\n                <button\r\n                    type=\"button\"\r\n                    onClick={onDeleteRequest}\r\n                    className=\"btn btn-danger-outline\"\r\n                    style={{ height: '52px', borderRadius: '12px', marginTop: '12px' }}\r\n                >\r\n                    <Trash2 size={18} style={{ marginRight: '8px' }} /> Apagar Registro\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Emprestimo' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, use } from \"react\";\r\nimport { ChevronLeft, AlertTriangle, UserX, CheckCircle, Clock } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Emprestimo } from \"@/types\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function LoanDetailsPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n    const { emprestimos, deletarEmprestimo } = useApp();\r\n    const router = useRouter();\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const emprestimo = emprestimos.find((l) => l.id === id) || null;\r\n\r\n    if (!emprestimo) return <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>Carregando...</div>;\r\n\r\n    const isPaid = emprestimo.status === 'pago';\r\n\r\n    // Stats\r\n    const stats = {\r\n        daysTotal: emprestimo.dias_contratados,\r\n        displayDuration: `${emprestimo.dias_contratados} dias`,\r\n        totalReceivable: emprestimo.valor_emprestado + emprestimo.juros_total_contratado,\r\n        interestOnly: emprestimo.juros_total_contratado,\r\n        // Overdue check\r\n        isOverdue: false\r\n    };\r\n\r\n    if (!isPaid) {\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n        const due = new Date(emprestimo.data_fim + 'T12:00:00');\r\n        due.setHours(0, 0, 0, 0);\r\n        stats.isOverdue = today > due;\r\n    }\r\n\r\n    const startDateStr = new Date(emprestimo.data_inicio + 'T12:00:00').toLocaleDateString('pt-BR');\r\n    const dueDateStr = new Date(emprestimo.data_fim + 'T12:00:00').toLocaleDateString('pt-BR');\r\n    const paymentDateStr = emprestimo.data_pagamento ? new Date(emprestimo.data_pagamento).toLocaleDateString('pt-BR') : '-';\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-lg)', gap: 'var(--space-sm)' }}>\r\n                <Link href=\"/loans\" style={{ padding: '8px', marginLeft: '-8px' }}>\r\n                    <ChevronLeft size={24} />\r\n                </Link>\r\n                <div>\r\n                    <h1 style={{ marginTop: '-4px' }}>Detalhes do Empréstimo</h1>\r\n                </div>\r\n            </header>\r\n\r\n            <div className=\"card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-md)' }}>\r\n                    <div>\r\n                        <h2 style={{ fontSize: '1.25rem', marginBottom: '4px' }}>\r\n                            {emprestimo.cliente_nome}\r\n                        </h2>\r\n                        <p style={{ fontSize: '0.9rem', color: 'var(--color-text-secondary)' }}>Criado em {startDateStr}</p>\r\n                    </div>\r\n                    <div>\r\n                        {isPaid ? (\r\n                            <div style={{ textAlign: 'right' }}>\r\n                                <span style={{ fontSize: '0.8rem', background: 'var(--color-success)', color: 'white', padding: '4px 8px', borderRadius: '4px', display: 'flex', alignItems: 'center', gap: '4px', justifyContent: 'flex-end' }}>\r\n                                    <CheckCircle size={12} /> ENCERRADO\r\n                                </span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-success)', marginTop: '4px' }}>\r\n                                    Em {paymentDateStr}\r\n                                </div>\r\n                            </div>\r\n                        ) : stats.isOverdue ? (\r\n                            <span style={{ fontSize: '0.8rem', background: 'var(--color-danger)', color: 'white', padding: '4px 8px', borderRadius: '4px', display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                <AlertTriangle size={14} /> VENCIDO\r\n                            </span>\r\n                        ) : (\r\n                            <span style={{ fontSize: '0.8rem', background: 'var(--color-primary)', color: 'white', padding: '4px 8px', borderRadius: '4px' }}>ATIVO</span>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Timeline */}\r\n                <div style={{ margin: 'var(--space-lg) 0', padding: '10px 0', borderTop: '1px dashed var(--color-border)', borderBottom: '1px dashed var(--color-border)' }}>\r\n                    <h3 style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)', marginBottom: '10px', textTransform: 'uppercase', letterSpacing: '1px' }}>Linha do Tempo</h3>\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', position: 'relative', fontSize: '0.8rem' }}>\r\n                        {/* Line */}\r\n                        <div style={{ position: 'absolute', top: '12px', left: '10px', right: '10px', height: '2px', background: 'var(--color-border)', zIndex: 0 }}></div>\r\n\r\n                        {/* Start Node */}\r\n                        <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                            <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-surface-2)', border: '2px solid var(--color-text-tertiary)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                <Clock size={12} color=\"var(--color-text-tertiary)\" />\r\n                            </div>\r\n                            <span style={{ fontWeight: 600 }}>Início</span>\r\n                            <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{startDateStr}</div>\r\n                        </div>\r\n\r\n                        {/* Middle/End Node - Dynamic */}\r\n                        {isPaid ? (\r\n                            <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                                <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-success)', border: '2px solid var(--color-success)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                    <CheckCircle size={14} color=\"white\" />\r\n                                </div>\r\n                                <span style={{ fontWeight: 600, color: 'var(--color-success)' }}>Pago</span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{paymentDateStr}</div>\r\n                            </div>\r\n                        ) : stats.isOverdue ? (\r\n                            <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                                <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-danger)', border: '2px solid var(--color-danger)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                    <AlertTriangle size={14} color=\"white\" />\r\n                                </div>\r\n                                <span style={{ fontWeight: 600, color: 'var(--color-danger)' }}>Vencido</span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{dueDateStr}</div>\r\n                            </div>\r\n                        ) : (\r\n                            <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                                <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-surface-2)', border: '2px solid var(--color-primary)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                    <Clock size={12} color=\"var(--color-primary)\" />\r\n                                </div>\r\n                                <span style={{ fontWeight: 600 }}>Previsto</span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{dueDateStr}</div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 'var(--space-lg)' }}>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Valor Emprestado</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\r\n                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(emprestimo.valor_emprestado)}\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Juros Mensal</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\r\n                            {emprestimo.juros_mensal}% a.m.\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Duração Contratada</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\r\n                            {stats.displayDuration}\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Lucro Garantido</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600', color: 'var(--color-success)' }}>\r\n                            + {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(stats.interestOnly)}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ background: 'var(--color-surface-2)', padding: '16px', borderRadius: '8px', marginTop: 'var(--space-lg)' }}>\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>\r\n                        <span style={{ fontWeight: '600' }}>Total {isPaid ? 'Pago' : 'a Receber'}</span>\r\n                        <span style={{ fontWeight: '700', fontSize: '1.2rem', color: 'var(--color-primary)' }}>\r\n                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(stats.totalReceivable)}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Admin Actions: Always available */}\r\n            <div style={{ marginTop: 'var(--space-xl)' }}>\r\n                <h3 style={{ fontSize: '0.9rem', marginBottom: 'var(--space-md)', color: 'var(--color-text-secondary)' }}>Ações de Controle</h3>\r\n                <button\r\n                    onClick={() => setIsDeleteModalOpen(true)}\r\n                    className=\"btn btn-full\"\r\n                    style={{ background: 'transparent', border: '1px solid var(--color-danger)', color: 'var(--color-danger)', justifyContent: 'center' }}\r\n                >\r\n                    <UserX size={18} style={{ marginRight: '8px' }} /> Apagar Empréstimo\r\n                </button>\r\n            </div>\r\n\r\n            <DeleteConfirmModal\r\n                isOpen={isDeleteModalOpen}\r\n                onClose={() => setIsDeleteModalOpen(false)}\r\n                onConfirm={async () => {\r\n                    await deletarEmprestimo(emprestimo.id);\r\n                    router.push(\"/loans\");\r\n                }}\r\n                itemName={emprestimo.cliente_nome}\r\n                itemType=\"Empréstimo\"\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":4,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":4,"column":63,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":68},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":4,"column":98,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":110},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Activity' is defined but never used.","line":4,"column":137,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":145},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":7,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'start' is assigned a value but never used.","line":68,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentMesRef' is assigned a value but never used.","line":111,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":111,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport Link from \"next/link\";\nimport { ArrowRight, Wallet, Building, TrendingUp, RefreshCw, Clock, AlertTriangle, CheckCircle, TrendingDown, Table, Download, LogOut, Activity, ShieldCheck } from \"lucide-react\";\nimport { useApp } from \"@/context/AppContext\";\nimport { useAuth } from \"@/context/AuthContext\";\nimport { useState, useEffect, useMemo } from \"react\";\nimport { useToast } from \"@/components/ToastProvider\";\nimport { useFinancialData } from \"@/hooks/useFinancialData\";\nimport { exportToCSV } from \"@/utils/exportUtils\";\nimport { supabase } from \"@/lib/supabaseClient\";\nimport SystemHealthModal from \"@/components/SystemHealthModal\";\n\n\nexport default function Home() {\n  // V1.0.1 - Force Deploy for Env Vars\n  const { imoveis, emprestimos, imoveisPagamentos, refreshData, loading } = useApp();\n  const { showToast } = useToast();\n  const { signOut } = useAuth(); // Auth Hook\n\n  // --- STRICT DATA INTEGRITY & CALCULATION HOOK ---\n  const { dashboard, spreadsheet } = useFinancialData();\n  const {\n    rentalRevenue,\n    rentalNetProfit,\n    loanRevenue,\n    totalLoanInterestContracted,\n  } = dashboard;\n\n  // Local state for time and formatting\n  const [now, setNow] = useState(new Date());\n  const [refreshKey, setRefreshKey] = useState(0);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  // Health Check State\n  const [isHealthModalOpen, setIsHealthModalOpen] = useState(false);\n  const [isCheckingHealth, setIsCheckingHealth] = useState(false);\n  const [healthData, setHealthData] = useState<{\n    supabase: boolean;\n    lastHeartbeat: string | null;\n    isHealthy: boolean;\n    checkedAt: string;\n  } | null>(null);\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setNow(new Date());\n    }, 1000 * 60);\n    return () => clearInterval(timer);\n  }, []);\n\n  const handleRefresh = async () => {\n    setIsRefreshing(true);\n    await refreshData();\n    setTimeout(() => {\n      setRefreshKey(prev => prev + 1);\n      setNow(new Date());\n      setIsRefreshing(false);\n      showToast(\"Painel atualizado e recalculado\", \"success\");\n    }, 500);\n  };\n\n  const handleCheckHealth = async () => {\n    setIsCheckingHealth(true);\n    setIsHealthModalOpen(true);\n\n    try {\n      const start = Date.now();\n\n      // 1. Test Supabase Connection (Read-only)\n      const { data, error } = await supabase\n        .from('system_health')\n        .select('last_ping_at')\n        .eq('id', '00000000-0000-0000-0000-000000000001')\n        .single();\n\n      const supabaseConnected = !error;\n      const lastHeartbeat = data?.last_ping_at || null;\n\n      // 2. Determine Health\n      // Healthy if connected AND heartbeat is < 26 hours old (buffer over 24h)\n      let isHealthy = supabaseConnected && !!lastHeartbeat;\n      if (lastHeartbeat) {\n        const diff = Date.now() - new Date(lastHeartbeat).getTime();\n        if (diff > 26 * 60 * 60 * 1000) isHealthy = false;\n      }\n\n      setHealthData({\n        supabase: supabaseConnected,\n        lastHeartbeat,\n        isHealthy,\n        checkedAt: new Date().toISOString()\n      });\n\n    } catch (err) {\n      console.error(\"Health check failed:\", err);\n      setHealthData({\n        supabase: false,\n        lastHeartbeat: null,\n        isHealthy: false,\n        checkedAt: new Date().toISOString()\n      });\n    } finally {\n      setIsCheckingHealth(false);\n    }\n  };\n\n  const currentYear = now.getFullYear();\n  const currentMonth = now.getMonth();\n  // Fixed Month Ref for DB comparison (YYYY-MM-01)\n  const currentMesRef = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-01`;\n\n  const monthName = now.toLocaleString('pt-BR', { month: 'long', year: 'numeric' });\n  const timeStr = now.toLocaleString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n\n  // EXPORT HANDLER\n  const handleExportDashboard = () => {\n    const formattedDate = now.toISOString().split('T')[0].split('-').reverse().join('-');\n    const formattedTime = now.toTimeString().split(' ')[0].replace(/:/g, '-').substring(0, 5);\n    const filename = `financeiro_${formattedDate}_${formattedTime}.csv`;\n\n    exportToCSV(spreadsheet.rentals, filename);\n    showToast(\"Download da planilha iniciado\", \"success\");\n  };\n\n  // --- ALERTS LOGIC (STRICT - RENTAL & LOANS) ---\n  const alerts: { id: string; type: 'warning' | 'danger' | 'info'; title: string; subtitle: string; propertyId: string; sortScore: number }[] = [];\n  let pendingRentalsCount = 0;\n\n  // 1. Get Today in Brazil (UTC-3)\n  const brOffset = -3;\n  const nowBr = new Date(new Date().getTime() + (brOffset * 60 * 60 * 1000) + (new Date().getTimezoneOffset() * 60 * 1000));\n  const todayDay = nowBr.getDate();\n  const currentMonthNum = nowBr.getMonth();\n  const currentYearNum = nowBr.getFullYear();\n\n  // Unified Month Ref for current check\n  const currentMesRefBr = `${currentYearNum}-${String(currentMonthNum + 1).padStart(2, '0')}-01`;\n\n  // Rental Alerts\n  imoveis.filter(p => p.ativo).forEach(imovel => {\n    const isPaidCurrentMonth = imoveisPagamentos.some(p => {\n      return p.imovel_id === imovel.id && p.status === 'pago' && p.mes_ref === currentMesRefBr;\n    });\n\n    const dueDay = imovel.dia_pagamento || 10;\n\n    if (!isPaidCurrentMonth) {\n      pendingRentalsCount++;\n      // Check current month due date\n      const dueDate = new Date(currentYearNum, currentMonthNum, dueDay, 12, 0, 0);\n      const formattedDueDate = dueDate.toLocaleDateString('pt-BR');\n      const diffDays = dueDay - todayDay;\n\n      if (diffDays < 0) {\n        alerts.push({\n          id: `prop-${imovel.id}`,\n          type: 'danger',\n          title: 'Aluguel Vencido',\n          subtitle: `${imovel.nome} - Venceu em ${formattedDueDate}`,\n          propertyId: imovel.id,\n          sortScore: 100\n        });\n      } else if (diffDays <= 3) {\n        const daysLabel = diffDays === 0 ? 'vence hoje' : diffDays === 1 ? 'vence em 1 dia' : `vence em ${diffDays} dias`;\n        alerts.push({\n          id: `prop-${imovel.id}`,\n          type: 'warning',\n          title: diffDays === 0 ? 'Vence Hoje' : 'Próximo do Vencimento',\n          subtitle: `${imovel.nome} ${formattedDueDate.slice(0, 5)} (${daysLabel})`,\n          propertyId: imovel.id,\n          sortScore: 50\n        });\n      }\n    } else {\n      // LOOKAHEAD: Current month is paid, check next month\n      const nextMonthDate = new Date(currentYearNum, currentMonthNum + 1, 1, 12, 0, 0);\n      const nextMonthNum = nextMonthDate.getMonth();\n      const nextYearNum = nextMonthDate.getFullYear();\n\n      const nextDueDate = new Date(nextYearNum, nextMonthNum, dueDay, 12, 0, 0);\n      const formattedNextDueDate = nextDueDate.toLocaleDateString('pt-BR');\n\n      // Calculate diff between Next Due Date and Today\n      const diffTime = nextDueDate.getTime() - nowBr.getTime();\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n      if (diffDays >= 0 && diffDays <= 3) {\n        const daysLabel = diffDays === 0 ? 'vence hoje' : diffDays === 1 ? 'vence em 1 dia' : `vence em ${diffDays} dias`;\n        alerts.push({\n          id: `prop-${imovel.id}-next`,\n          type: 'warning',\n          title: 'Próximo Vencimento',\n          subtitle: `${imovel.nome} ${formattedNextDueDate.slice(0, 5)} (${daysLabel})`,\n          propertyId: imovel.id,\n          sortScore: 45 // Slightly lower than current month upcoming\n        });\n      }\n    }\n  });\n\n  // Loan Alerts\n  emprestimos.filter(l => l.status === 'ativo' && l.data_fim).forEach(loan => {\n    if (!loan.data_fim) return;\n    const due = new Date(loan.data_fim + 'T12:00:00');\n    due.setHours(0, 0, 0, 0);\n    const today = new Date(nowBr);\n    today.setHours(0, 0, 0, 0);\n\n    const diffTime = due.getTime() - today.getTime();\n    const loanDiffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n    if (loanDiffDays < 0) {\n      alerts.push({\n        id: `loan-${loan.id}`,\n        type: 'danger',\n        title: 'Empréstimo Atrasado',\n        subtitle: `${loan.cliente_nome}`,\n        propertyId: `/loans/${loan.id}`,\n        sortScore: 90 // Below rent overdue\n      });\n    } else if (loanDiffDays <= 3) {\n      alerts.push({\n        id: `loan-${loan.id}`,\n        type: 'warning',\n        title: loanDiffDays === 0 ? 'Vence Hoje' : 'Empréstimo Vencendo',\n        subtitle: `${loan.cliente_nome} - ${due.toLocaleDateString('pt-BR')}`,\n        propertyId: `/loans/${loan.id}`,\n        sortScore: 40\n      });\n    }\n  });\n\n  // Sort: Danger (higher score) first\n  alerts.sort((a, b) => b.sortScore - a.sortScore);\n\n  const totalNetProfit = rentalNetProfit + totalLoanInterestContracted;\n\n  return (\n    <div className=\"container\" key={refreshKey} style={{ maxWidth: '800px', margin: '0 auto' }}>\n      {loading ? (\n        <div style={{ display: 'flex', justifyContent: 'center', paddingTop: '50px' }}>Carregando...</div>\n      ) : (\n        <>\n          {/* HEADER: Context & Verification */}\n          <header style={{\n            marginBottom: 'var(--space-lg)',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n          }}>\n            <div>\n              <div style={{ fontSize: '0.75rem', textTransform: 'uppercase', letterSpacing: '1px', fontWeight: 'bold', color: 'var(--color-primary)', display: 'flex', alignItems: 'center', gap: '6px', background: 'rgba(var(--color-primary-rgb), 0.1)', padding: '4px 8px', borderRadius: '4px', width: 'fit-content', marginBottom: '8px' }}>\n                <CheckCircle size={10} /> App Financeiro Pessoal\n              </div>\n              <div style={{ fontSize: '1.2rem', fontWeight: 'bold' }}>Dashboard</div>\n              <div style={{ fontSize: '0.85rem', color: 'var(--color-text-secondary)' }}>{monthName} • {timeStr}</div>\n            </div>\n\n            <div style={{ textAlign: 'right' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '6px', justifyContent: 'flex-end', marginBottom: '8px' }}>\n                <span style={{ fontSize: '0.75rem', fontWeight: '600', color: isRefreshing ? 'var(--color-warning)' : 'var(--color-success)', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                  {isRefreshing ? <RefreshCw size={10} className=\"spin-anim\" /> : <CheckCircle size={10} />}\n                  {isRefreshing ? 'Atualizando...' : 'Dados Atualizados'}\n                </span>\n              </div>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', justifyContent: 'flex-end', flexWrap: 'wrap' }}>\n                <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>\n                  <button onClick={handleCheckHealth} style={{ fontSize: '0.8rem', color: 'var(--color-text-primary)', background: 'var(--color-surface-2)', border: '1px solid var(--color-border)', borderRadius: '4px', padding: '4px 8px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                    <ShieldCheck size={12} color=\"var(--color-primary)\" /> Verificar Sistema\n                  </button>\n                  <button onClick={handleRefresh} style={{ fontSize: '0.8rem', color: 'var(--color-primary)', background: 'none', border: 'none', cursor: 'pointer', textDecoration: 'underline' }}>\n                    Forçar Atualização\n                  </button>\n                </div>\n                <button onClick={signOut} style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)', background: 'none', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '4px', borderLeft: '1px solid var(--color-border)', paddingLeft: '12px' }}>\n                  <LogOut size={14} /> Sair\n                </button>\n              </div>\n            </div>\n          </header>\n\n          {/* MAIN INDICATOR */}\n          <div className=\"card\" style={{ background: 'var(--color-primary)', color: 'white', marginBottom: 'var(--space-xl)', textAlign: 'center', padding: '32px' }}>\n            <div style={{ fontSize: '0.9rem', opacity: 0.9, marginBottom: '8px', textTransform: 'uppercase' }}>Lucro Líquido Geral Estimado</div>\n            <div style={{ fontSize: '2.5rem', fontWeight: '800' }}>\n              {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalNetProfit)}\n            </div>\n            <div style={{ fontSize: '0.8rem', opacity: 0.8, marginTop: '8px' }}>\n              Considerando aluguéis e juros contratados\n            </div>\n          </div>\n\n\n          {/* --- BLOCK 1: ALUGUÉIS --- */}\n          <section style={{ marginBottom: 'var(--space-xl)' }}>\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-md)' }}>\n              <h2 style={{ fontSize: '1.1rem', display: 'flex', alignItems: 'center', gap: '8px', fontWeight: '700' }}>\n                <Building size={20} color=\"var(--color-primary)\" /> Imóveis\n              </h2>\n              <Link href=\"/properties\" style={{ fontSize: '0.85rem', color: 'var(--color-primary)' }}>Gerenciar</Link>\n            </div>\n\n            <Link href=\"/properties\" className=\"card\" style={{ display: 'block', borderLeft: '4px solid var(--color-primary)', textDecoration: 'none', transition: 'transform 0.1s' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <div>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-secondary)' }}>Lucro Líquido (Mês)</div>\n                  <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--color-text-primary)' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(rentalNetProfit)}\n                  </div>\n                </div>\n                <div style={{ textAlign: 'right' }}>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)' }}>Receita Bruta</div>\n                  <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(rentalRevenue)}\n                  </div>\n                </div>\n              </div>\n\n              {pendingRentalsCount > 0 && (\n                <div style={{ marginTop: '12px', paddingTop: '12px', borderTop: '1px solid var(--color-border-subtle)', color: 'var(--color-warning-dark)', fontSize: '0.85rem', display: 'flex', alignItems: 'center', gap: '6px' }}>\n                  <AlertTriangle size={14} /> {pendingRentalsCount} aluguéis pendentes este mês\n                </div>\n              )}\n            </Link>\n          </section>\n\n          {/* --- BLOCK 2: EMPRÉSTIMOS --- */}\n          <section style={{ marginBottom: 'var(--space-xl)' }}>\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-md)' }}>\n              <h2 style={{ fontSize: '1.1rem', display: 'flex', alignItems: 'center', gap: '8px', fontWeight: '700' }}>\n                <Wallet size={20} color=\"var(--color-success)\" /> Empréstimos\n              </h2>\n              <Link href=\"/loans\" style={{ fontSize: '0.85rem', color: 'var(--color-primary)' }}>Gerenciar</Link>\n            </div>\n\n            <Link href=\"/loans\" className=\"card\" style={{ display: 'block', borderLeft: '4px solid var(--color-success)', textDecoration: 'none' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <div>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-secondary)' }}>Lucro Juros (Total Contratado)</div>\n                  <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--color-text-primary)' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalLoanInterestContracted)}\n                  </div>\n                </div>\n                <div style={{ textAlign: 'right' }}>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)' }}>Valor a Receber</div>\n                  <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(loanRevenue)}\n                  </div>\n                </div>\n              </div>\n            </Link>\n          </section>\n\n          {/* --- QUICK ACTIONS & ALERTS (VISUAL UPDATE: STACKED & NEUTRAL) --- */}\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-xl)', marginBottom: 'var(--space-xl)' }}>\n\n            {/* ALERTS SECTION (Conditional) */}\n            {alerts.length > 0 && (\n              <section>\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '12px' }}>\n                  <h3 style={{ fontSize: '0.9rem', color: 'var(--color-text-secondary)', textTransform: 'uppercase', display: 'flex', alignItems: 'center', gap: '6px' }}>\n                    <AlertTriangle size={16} /> Atenção Necessária\n                  </h3>\n                </div>\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n                  {alerts.map(alert => (\n                    <Link href={alert.propertyId.startsWith('/') ? alert.propertyId : `/properties/${alert.propertyId}`} key={alert.id} className=\"card\" style={{\n                      display: 'flex', alignItems: 'center', justifyContent: 'space-between',\n                      border: '1px solid var(--color-border)',\n                      // NEUTRAL/LIGHT BORDER - No heavy red/orange\n                      borderLeft: `4px solid ${alert.type === 'danger' ? 'var(--color-text-secondary)' : 'var(--color-text-tertiary)'}`,\n                      background: 'var(--color-surface-1)',\n                      padding: '16px 20px',\n                      textDecoration: 'none',\n                      boxShadow: 'none'\n                    }}>\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\n                        {/* Icon Container - Provides the color signal without overwhelming */}\n                        <div style={{\n                          color: alert.type === 'danger' ? 'var(--color-danger)' : 'var(--color-warning)',\n                          background: alert.type === 'danger' ? 'rgba(var(--color-danger-rgb), 0.1)' : 'rgba(var(--color-warning-rgb), 0.1)',\n                          padding: '10px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyItems: 'center'\n                        }}>\n                          <AlertTriangle size={20} />\n                        </div>\n                        <div>\n                          <div style={{ fontWeight: '600', color: 'var(--color-text-primary)', fontSize: '0.95rem' }}>{alert.title}</div>\n                          <div style={{ fontSize: '0.85rem', color: 'var(--color-text-secondary)' }}>{alert.subtitle}</div>\n                        </div>\n                      </div>\n                      <ArrowRight size={18} color=\"var(--color-text-tertiary)\" />\n                    </Link>\n                  ))}\n                </div>\n              </section>\n            )}\n\n            {/* QUICK ACTIONS (ALWAYS LARGE, FIXED LAYOUT) */}\n            <section>\n              <h3 style={{ fontSize: '0.9rem', color: 'var(--color-text-secondary)', marginBottom: '12px', textTransform: 'uppercase' }}>Ações Rápidas</h3>\n              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>\n                <Link href=\"/spreadsheet\" className=\"btn\" style={{\n                  background: 'var(--color-surface-2)',\n                  color: 'var(--color-text-primary)',\n                  flexDirection: 'column',\n                  padding: '24px',\n                  gap: '12px',\n                  height: '100%',\n                  justifyContent: 'center',\n                  border: '1px solid var(--color-border)',\n                  borderRadius: 'var(--radius-md)',\n                  minHeight: '120px' // Ensure large fixed target\n                }}>\n                  <Table size={32} strokeWidth={1.5} />\n                  <span style={{ fontSize: '0.9rem', fontWeight: '600' }}>Planilha Geral</span>\n                </Link>\n\n                <button onClick={handleExportDashboard} className=\"btn\" style={{\n                  background: 'var(--color-surface-2)',\n                  color: 'var(--color-text-primary)',\n                  flexDirection: 'column',\n                  padding: '24px',\n                  gap: '12px',\n                  height: '100%',\n                  justifyContent: 'center',\n                  border: '1px solid var(--color-border)',\n                  borderRadius: 'var(--radius-md)',\n                  minHeight: '120px' // Ensure large fixed target\n                }}>\n                  <Download size={32} strokeWidth={1.5} />\n                  <span style={{ fontSize: '0.9rem', fontWeight: '600' }}>Exportar CSV</span>\n                </button>\n              </div>\n            </section>\n          </div>\n\n        </>\n      )}\n\n      <SystemHealthModal\n        isOpen={isHealthModalOpen}\n        onClose={() => setIsHealthModalOpen(false)}\n        isLoading={isCheckingHealth}\n        healthData={healthData}\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\[id]\\edit\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'onDelete' is defined but never used.","line":70,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":80,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":80,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { use, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { ChevronLeft, Save, Trash2, User, Home, DollarSign, Calendar } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Imovel } from \"@/types\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function EditPropertyPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n\r\n    const router = useRouter();\r\n    const { imoveis, atualizarImovel, deletarImovel } = useApp();\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const property = imoveis.find((p) => p.id === id) || null;\r\n\r\n    if (!property) {\r\n        return (\r\n            <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>\r\n                <p>Carregando imóvel...</p>\r\n                <Link href=\"/properties\" className=\"btn\" style={{ marginTop: '16px' }}>Voltar</Link>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main style={{ minHeight: '100vh', background: 'var(--color-background)', padding: 'var(--space-md) 0' }}>\r\n            <div className=\"container\" style={{ maxWidth: '800px' }}>\r\n                <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-xl)', gap: 'var(--space-sm)' }}>\r\n                    <Link href={`/properties/${id}`} style={{\r\n                        padding: '10px',\r\n                        marginLeft: '-10px',\r\n                        color: 'var(--color-text-secondary)',\r\n                        transition: 'color 0.2s'\r\n                    }} className=\"hover-primary\">\r\n                        <ChevronLeft size={24} />\r\n                    </Link>\r\n                    <h1 style={{ fontSize: '1.75rem', fontWeight: 800, letterSpacing: '-0.03em' }}>Editar Imóvel</h1>\r\n                </header>\r\n\r\n                <PropertyEditForm\r\n                    property={property}\r\n                    onSubmit={atualizarImovel}\r\n                    onDelete={deletarImovel}\r\n                    onDeleteRequest={() => setIsDeleteModalOpen(true)}\r\n                    onSuccess={() => router.push(\"/properties\")}\r\n                />\r\n\r\n                <DeleteConfirmModal\r\n                    isOpen={isDeleteModalOpen}\r\n                    onClose={() => setIsDeleteModalOpen(false)}\r\n                    onConfirm={async () => {\r\n                        await deletarImovel(property.id);\r\n                        router.push(\"/properties\");\r\n                    }}\r\n                    itemName={property.nome}\r\n                    itemType=\"Imóvel\"\r\n                />\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n\r\nfunction PropertyEditForm({\r\n    property,\r\n    onSubmit,\r\n    onDelete,\r\n    onSuccess,\r\n    onDeleteRequest\r\n}: {\r\n    property: Imovel,\r\n    onSubmit: (id: string, updates: Partial<Imovel>) => Promise<void>,\r\n    onDelete: (id: string) => Promise<void>,\r\n    onSuccess: () => void,\r\n    onDeleteRequest: () => void\r\n}) {\r\n    const router = useRouter();\r\n    const [formData, setFormData] = useState({\r\n        name: property.nome,\r\n        clientName: property.cliente_nome || \"\",\r\n        phone: property.telefone || \"\",\r\n        address: property.endereco || \"\",\r\n        rentAmount: property.valor_aluguel.toString().replace('.', ','),\r\n        paymentDay: (property.dia_pagamento || 10).toString(),\r\n    });\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        await onSubmit(property.id, {\r\n            nome: formData.name,\r\n            cliente_nome: formData.clientName,\r\n            telefone: formData.phone,\r\n            endereco: formData.address,\r\n            valor_aluguel: parseFloat(formData.rentAmount.replace(',', '.')),\r\n            dia_pagamento: parseInt(formData.paymentDay) || 10,\r\n            ativo: property.ativo\r\n        });\r\n        onSuccess();\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-lg)' }}>\r\n\r\n            {/* Seção 1: Dados do Cliente */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <User size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Dados do Cliente</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Nome do Inquilino</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.clientName}\r\n                            onChange={(e) => setFormData({ ...formData, clientName: e.target.value })}\r\n                            placeholder=\"Ex: João Silva\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Telefone de Contato</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.phone}\r\n                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                            placeholder=\"(00) 00000-0000\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Seção 2: Detalhes do Imóvel */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <Home size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Informações do Imóvel</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: 'var(--space-lg)' }}>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Identificação / Apelido</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                            placeholder=\"Ex: Apartamento 202 - Centro\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Endereço Completo</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.address}\r\n                            onChange={(e) => setFormData({ ...formData, address: e.target.value })}\r\n                            placeholder=\"Rua, número, bairro e cidade\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <DollarSign size={12} /> Valor Mensal\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"input\"\r\n                                style={{ fontSize: '1.25rem', fontWeight: 700, color: 'var(--color-primary)' }}\r\n                                value={formData.rentAmount}\r\n                                onChange={(e) => setFormData({ ...formData, rentAmount: e.target.value })}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Calendar size={12} /> Dia de Vencimento\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"input\"\r\n                                min=\"1\"\r\n                                max=\"31\"\r\n                                value={formData.paymentDay}\r\n                                onChange={(e) => setFormData({ ...formData, paymentDay: e.target.value })}\r\n                                placeholder=\"10\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Ações */}\r\n            <div style={{ marginTop: 'var(--space-lg)', display: 'flex', flexDirection: 'column', gap: 'var(--space-md)' }}>\r\n                <button type=\"submit\" className=\"btn btn-success\" style={{ height: '56px', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)' }}>\r\n                    <Save size={20} style={{ marginRight: '10px' }} />\r\n                    <span style={{ fontWeight: 700 }}>Salvar Alterações</span>\r\n                </button>\r\n\r\n                <button\r\n                    type=\"button\"\r\n                    onClick={onDeleteRequest}\r\n                    className=\"btn btn-danger-outline\"\r\n                    style={{ height: '52px', borderRadius: '12px', marginTop: '12px' }}\r\n                >\r\n                    <Trash2 size={18} style={{ marginRight: '8px' }} /> Excluir Imóvel\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Imovel' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImovelPagamento' is defined but never used.","line":7,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":33}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { use, useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { ChevronLeft, CheckCircle, Edit2, Phone, MapPin, User, History, BarChart3 } from \"lucide-react\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Imovel, ImovelPagamento } from \"@/types\";\r\nimport { useToast } from \"@/components/ToastProvider\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function PropertyDetailsPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n\r\n    const { imoveis, imoveisPagamentos, imoveisGastos, receberPagamento, deletarImovel, loading } = useApp();\r\n    const { showToast } = useToast();\r\n    const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n\r\n    const imovel = imoveis.find((p) => p.id === id) || null;\r\n    const history = imoveisPagamentos\r\n        .filter((p) => p.imovel_id === id)\r\n        .sort((a, b) => new Date(b.mes_ref).getTime() - new Date(a.mes_ref).getTime());\r\n\r\n    // Current Month Status Logic\r\n    const now = new Date();\r\n    const currentYear = now.getFullYear();\r\n    const currentMonth = now.getMonth();\r\n    const currentMesRef = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-01`;\r\n    const isPaidThisMonth = history.some(p => p.mes_ref === currentMesRef && p.status === 'pago');\r\n    const currentMonthName = now.toLocaleString('pt-BR', { month: 'long' });\r\n\r\n    const handlePayment = async () => {\r\n        if (!imovel) return;\r\n        try {\r\n            await receberPagamento(imovel.id, new Date());\r\n            showToast(\"Pagamento registrado com sucesso\", \"success\");\r\n        } catch (error) {\r\n            console.error(error);\r\n            showToast(\"Erro ao registrar pagamento\", \"error\");\r\n        }\r\n    };\r\n\r\n    if (loading || !imovel) {\r\n        return (\r\n            <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>\r\n                <p>{loading ? \"Carregando imóvel...\" : \"Imóvel não encontrado...\"}</p>\r\n                {!loading && <Link href=\"/properties\" className=\"btn btn-primary\" style={{ marginTop: 'var(--space-md)' }}>Voltar</Link>}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-lg)', gap: 'var(--space-sm)' }}>\r\n                <Link href=\"/properties\" style={{ padding: '8px', marginLeft: '-8px' }}>\r\n                    <ChevronLeft size={24} />\r\n                </Link>\r\n                <h1 style={{ fontSize: '1.5rem', whiteSpace: 'nowrap', overflow: 'hidden', textOverflow: 'ellipsis', flex: 1 }}>\r\n                    {imovel.nome}\r\n                </h1>\r\n                <div style={{ display: 'flex', gap: '8px' }}>\r\n                    <Link href={`/properties/${imovel.id}/edit`} className=\"btn\" style={{ padding: '8px 12px', fontSize: '0.8rem', display: 'flex', alignItems: 'center', gap: '6px', background: 'var(--color-surface-2)', border: '1px solid var(--color-border)' }}>\r\n                        <Edit2 size={14} /> Editar\r\n                    </Link>\r\n                    <button onClick={() => setShowDeleteModal(true)} className=\"btn\" style={{ padding: '8px 12px', fontSize: '0.8rem', display: 'flex', alignItems: 'center', gap: '6px', background: 'var(--color-surface-2)', border: '1px solid var(--color-danger)', color: 'var(--color-danger)' }}>\r\n                        Apagar\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            <div className=\"card\" style={{ marginBottom: 'var(--space-md)' }}>\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 'var(--space-md)', marginBottom: 'var(--space-sm)' }}>\r\n                    <div>\r\n                        <span className=\"label\" style={{ display: 'flex', alignItems: 'center', gap: '4px' }}><User size={12} /> Cliente</span>\r\n                        <div style={{ fontWeight: '600' }}>{imovel.cliente_nome || \"Não informado\"}</div>\r\n                    </div>\r\n                    <div>\r\n                        <span className=\"label\" style={{ display: 'flex', alignItems: 'center', gap: '4px' }}><Phone size={12} /> Contato</span>\r\n                        <div style={{ fontWeight: '600' }}>{imovel.telefone || \"Não informado\"}</div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ marginBottom: 'var(--space-md)' }}>\r\n                    <span className=\"label\" style={{ display: 'flex', alignItems: 'center', gap: '4px' }}><MapPin size={12} /> Endereço</span>\r\n                    <div style={{ fontSize: '1rem', fontWeight: '500' }}>\r\n                        {imovel.endereco || <span style={{ color: 'var(--color-text-tertiary)', fontStyle: 'italic' }}>Endereço não informado</span>}\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ borderTop: '1px solid var(--color-border)', paddingTop: 'var(--space-md)' }}>\r\n                    <span className=\"label\">Valor Aluguel</span>\r\n                    <div style={{ fontWeight: '800', fontSize: '1.4rem', color: 'var(--color-primary)' }}>\r\n                        {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(imovel.valor_aluguel)}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-md)' }}>\r\n                <h3 style={{ fontSize: '1.1rem' }}>Pagamentos</h3>\r\n                {/* Use Same Logic as Card */}\r\n                {!isPaidThisMonth ? (\r\n                    <button\r\n                        onClick={() => setShowPaymentModal(true)}\r\n                        className=\"btn btn-primary\"\r\n                        style={{ fontSize: '0.8rem', padding: '0.5rem 0.8rem', background: 'var(--color-success)', color: 'white' }}\r\n                    >\r\n                        Registrar {currentMonthName}\r\n                    </button>\r\n                ) : (\r\n                    <span style={{ fontSize: '0.8rem', color: 'var(--color-success)', fontWeight: 'bold', display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                        <CheckCircle size={14} /> {currentMonthName} Pago\r\n                    </span>\r\n                )}\r\n            </div>\r\n\r\n            {history.length === 0 ? (\r\n                <div style={{ padding: 'var(--space-lg)', textAlign: 'center', color: 'var(--color-text-secondary)', background: 'var(--color-surface-2)', borderRadius: 'var(--radius-md)' }}>\r\n                    Nenhum pagamento registrado nos últimos 12 meses.\r\n                </div>\r\n            ) : (\r\n                <div style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-sm)' }}>\r\n                    <div style={{ padding: '8px', color: 'var(--color-text-tertiary)', fontSize: '0.8rem', fontWeight: 'bold', textTransform: 'uppercase', display: 'flex', alignItems: 'center', gap: '6px' }}>\r\n                        <BarChart3 size={16} /> Relatório Financeiro (Resumido)\r\n                    </div>\r\n                    {history.map((payment) => {\r\n                        const [y, m, d] = payment.mes_ref.split('-');\r\n                        const dateObj = new Date(Number(y), Number(m) - 1, Number(d), 12, 0, 0); // Noon to avoid timezone shift\r\n                        const monthLabel = dateObj.toLocaleString('pt-BR', { month: 'long', year: 'numeric' });\r\n\r\n                        // Calculate Expenses for this month reference\r\n                        const monthExpenses = imoveisGastos.filter(g =>\r\n                            g.imovel_id === id && g.mes_ref === payment.mes_ref\r\n                        );\r\n                        const totalExpense = monthExpenses.reduce((acc, curr) => acc + curr.valor, 0);\r\n                        const gross = payment.valor_pago || 0;\r\n                        const net = gross - totalExpense;\r\n\r\n                        return (\r\n                            <div key={payment.id} className=\"card\" style={{ padding: 'var(--space-sm) var(--space-md)', background: payment.status === 'pago' ? 'white' : 'var(--color-surface-1)' }}>\r\n                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '10px' }}>\r\n                                    <div>\r\n                                        <div style={{ fontWeight: '700', textTransform: 'capitalize', fontSize: '1rem' }}>\r\n                                            {monthLabel}\r\n                                        </div>\r\n                                        <div style={{ fontSize: '0.8rem', display: 'flex', gap: '8px' }}>\r\n                                            <span style={{ color: payment.status === 'pendente' ? 'var(--color-warning)' : 'var(--color-success)', fontWeight: 'bold' }}>\r\n                                                {payment.status === 'pago' ? 'PAGO' : 'PENDENTE'}\r\n                                            </span>\r\n                                            {payment.data_pagamento && (\r\n                                                <span style={{ color: 'var(--color-text-tertiary)' }}>\r\n                                                    em {new Date(payment.data_pagamento).toLocaleDateString('pt-BR')}\r\n                                                </span>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                    <div style={{ textAlign: 'right' }}>\r\n                                        <div style={{ fontSize: '0.7rem', color: 'var(--color-text-tertiary)', textTransform: 'uppercase', fontWeight: 'bold' }}>Lucro Líquido</div>\r\n                                        <div style={{ fontWeight: '800', fontSize: '1.1rem', color: net > 0 ? 'var(--color-primary)' : 'var(--color-danger)' }}>\r\n                                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(net)}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px', fontSize: '0.8rem', paddingTop: '10px', borderTop: '1px solid var(--color-border)', opacity: 0.8 }}>\r\n                                    <div style={{ color: 'var(--color-success)', fontWeight: '600' }}>\r\n                                        <div style={{ fontSize: '0.65rem', color: 'var(--color-text-tertiary)' }}>ALUGUEL</div>\r\n                                        +{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(gross)}\r\n                                    </div>\r\n                                    <div style={{ textAlign: 'right', color: totalExpense > 0 ? 'var(--color-danger)' : 'var(--color-text-tertiary)', fontWeight: '600' }}>\r\n                                        <div style={{ fontSize: '0.65rem', color: 'var(--color-text-tertiary)' }}>GASTOS</div>\r\n                                        {totalExpense > 0 ? '-' : ''}{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalExpense)}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {monthExpenses.length > 0 && (\r\n                                    <div style={{ marginTop: '10px', padding: '8px', background: 'var(--color-surface-2)', borderRadius: '6px', fontSize: '0.75rem' }}>\r\n                                        {monthExpenses.map((g, idx) => (\r\n                                            <div key={g.id} style={{ display: 'flex', justifyContent: 'space-between', marginBottom: idx === monthExpenses.length - 1 ? 0 : '4px' }}>\r\n                                                <span style={{ color: 'var(--color-text-secondary)' }}>• {g.descricao}</span>\r\n                                                <span style={{ fontWeight: '600' }}>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(g.valor)}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        );\r\n                    })}\r\n\r\n                    <div style={{ padding: '8px', marginTop: 'var(--space-md)', color: 'var(--color-text-tertiary)', fontSize: '0.8rem', fontWeight: 'bold', textTransform: 'uppercase', display: 'flex', alignItems: 'center', gap: '6px' }}>\r\n                        <History size={16} /> Histórico de Atividades\r\n                    </div>\r\n                    <div className=\"card\" style={{ padding: 'var(--space-md)', display: 'flex', flexDirection: 'column', gap: 'var(--space-sm)' }}>\r\n                        {history.filter(p => p.status === 'pago').map(p => {\r\n                            const [y, m, d] = p.mes_ref.split('-');\r\n                            const refDate = new Date(Number(y), Number(m) - 1, Number(d), 12, 0, 0);\r\n                            return (\r\n                                <div key={`hist-${p.id}`} style={{ fontSize: '0.85rem', display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid var(--color-surface-2)', paddingBottom: '8px' }}>\r\n                                    <span>Pagamento de <strong>{refDate.toLocaleString('pt-BR', { month: 'long' })}</strong> recebido</span>\r\n                                    <span style={{ color: 'var(--color-text-tertiary)' }}>{p.data_pagamento ? new Date(p.data_pagamento).toLocaleDateString('pt-BR') : '-'}</span>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                        {imoveisGastos.filter(g => g.imovel_id === id).sort((a, b) => new Date(b.mes_ref).getTime() - new Date(a.mes_ref).getTime()).map(g => (\r\n                            <div key={`hist-g-${g.id}`} style={{ fontSize: '0.85rem', display: 'flex', justifyContent: 'space-between', borderBottom: '1px solid var(--color-surface-2)', paddingBottom: '8px' }}>\r\n                                <span style={{ color: 'var(--color-danger)' }}>Gasto: {g.descricao}</span>\r\n                                <span style={{ color: 'var(--color-text-tertiary)' }}>{new Date(g.mes_ref + 'T12:00:00').toLocaleDateString('pt-BR')}</span>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            <DeleteConfirmModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => setShowDeleteModal(false)}\r\n                onConfirm={async () => {\r\n                    await deletarImovel(imovel.id);\r\n                    window.location.href = \"/properties\";\r\n                }}\r\n                itemName={imovel.nome}\r\n                itemType=\"Imóvel\"\r\n            />\r\n\r\n            <DeleteConfirmModal\r\n                isOpen={showPaymentModal}\r\n                onClose={() => setShowPaymentModal(false)}\r\n                onConfirm={handlePayment}\r\n                itemName={`${imovel.nome} (${currentMonthName}/${currentYear})`}\r\n                itemType=\"Imóvel\"\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Eye' is defined but never used.","line":5,"column":34,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit2' is defined but never used.","line":5,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport Link from \"next/link\";\r\nimport { useState } from \"react\";\r\nimport { Plus, Home as HomeIcon, Eye, Edit2, CheckCircle, AlertCircle, Search, BarChart3, X, Trash2, Lock } from \"lucide-react\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Imovel } from \"@/types\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function PropertiesPage() {\r\n    const { imoveis, loading } = useApp();\r\n\r\n    if (loading) {\r\n        return <div className=\"container\" style={{ textAlign: 'center', padding: 'var(--space-xl)' }}>Carregando...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <header style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-lg)' }}>\r\n                <h1>Meus Imóveis</h1>\r\n                <Link href=\"/properties/new\" className=\"btn btn-primary\" style={{ padding: '0.5rem 1rem' }}>\r\n                    <Plus size={20} /> <span style={{ marginLeft: '4px' }}>Novo</span>\r\n                </Link>\r\n            </header>\r\n\r\n            {imoveis.filter(p => p.ativo).length === 0 ? (\r\n                <div style={{ textAlign: 'center', padding: 'var(--space-xl) var(--space-md)', background: 'var(--color-surface-1)', borderRadius: 'var(--radius-lg)', border: '1px dashed var(--color-border)' }}>\r\n                    <HomeIcon size={48} style={{ color: 'var(--color-text-tertiary)', marginBottom: 'var(--space-md)', opacity: 0.5 }} />\r\n                    <h3 style={{ marginBottom: '8px', color: 'var(--color-text-secondary)' }}>Nenhum imóvel cadastrado</h3>\r\n                    <p style={{ marginBottom: 'var(--space-lg)', fontSize: '0.9rem' }}>Adicione seus imóveis para acompanhar aluguéis e gastos.</p>\r\n                    <Link href=\"/properties/new\" className=\"btn btn-primary\">\r\n                        Cadastrar Primeiro Imóvel\r\n                    </Link>\r\n                </div>\r\n            ) : (\r\n                <div style={{ display: 'grid', gap: 'var(--space-md)' }}>\r\n                    {imoveis.filter(p => p.ativo).map((imovel) => (\r\n                        <PropertyCard key={imovel.id} imovel={imovel} />\r\n                    ))}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction PropertyCard({ imovel }: { imovel: Imovel }) {\r\n    const { imoveisPagamentos, receberPagamento, adicionarGasto, deletarImovel } = useApp();\r\n    const [showGastoModal, setShowGastoModal] = useState(false);\r\n    const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n    const [gastoDesc, setGastoDesc] = useState(\"\");\r\n    const [gastoValor, setGastoValor] = useState(\"\");\r\n    const [isSavingGasto, setIsSavingGasto] = useState(false);\r\n    const [showPaymentModal, setShowPaymentModal] = useState(false);\r\n\r\n    // STRICT TIME SOURCE\r\n    const now = new Date();\r\n    const currentYear = now.getFullYear();\r\n    const currentMonth = now.getMonth();\r\n\r\n    const currentMesRef = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-01`;\r\n    const currentMonthName = now.toLocaleString('pt-BR', { month: 'long' });\r\n\r\n    const isPaidThisMonth = imoveisPagamentos.some(p => {\r\n        return p.imovel_id === imovel.id && p.status === 'pago' && p.mes_ref === currentMesRef;\r\n    });\r\n\r\n    const months = Array.from({ length: 12 }, (_, i) => i);\r\n    const timelineData = months.map(mIndex => {\r\n        const d = new Date(currentYear, mIndex, 1);\r\n        const label = d.toLocaleString('pt-BR', { month: 'short' }).replace('.', '');\r\n        const targetMesRef = `${currentYear}-${String(mIndex + 1).padStart(2, '0')}-01`;\r\n\r\n        const isMonthPaid = imoveisPagamentos.some(p => {\r\n            return p.imovel_id === imovel.id && p.status === 'pago' && p.mes_ref === targetMesRef;\r\n        });\r\n\r\n        return { label, isPaid: isMonthPaid, isCurrent: mIndex === currentMonth };\r\n    });\r\n\r\n    const handlePayment = async () => {\r\n        if (isPaidThisMonth) return;\r\n        await receberPagamento(imovel.id, new Date());\r\n    };\r\n\r\n    const handleSaveGasto = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!gastoDesc || !gastoValor) return;\r\n        setIsSavingGasto(true);\r\n        try {\r\n            await adicionarGasto({\r\n                imovel_id: imovel.id,\r\n                mes_ref: currentMesRef,\r\n                descricao: gastoDesc,\r\n                valor: parseFloat(gastoValor.replace(',', '.'))\r\n            });\r\n            setShowGastoModal(false);\r\n            setGastoDesc(\"\");\r\n            setGastoValor(\"\");\r\n        } finally {\r\n            setIsSavingGasto(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteImovel = async () => {\r\n        try {\r\n            await deletarImovel(imovel.id);\r\n            setShowDeleteModal(false);\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"card\" style={{ padding: 0, overflow: 'hidden', border: '1px solid var(--color-border)' }}>\r\n            <div style={{\r\n                background: isPaidThisMonth ? 'rgba(var(--color-success-rgb), 0.05)' : 'var(--color-surface-2)',\r\n                padding: '12px 16px',\r\n                borderBottom: '1px solid var(--color-border)',\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                alignItems: 'center',\r\n                flexWrap: 'wrap',\r\n                gap: '8px'\r\n            }}>\r\n                <div style={{ display: 'flex', gap: '3px', alignItems: 'center' }}>\r\n                    {timelineData.map((t, idx) => (\r\n                        <div key={idx} style={{\r\n                            width: '20px', height: '20px', borderRadius: '50%',\r\n                            background: t.isPaid ? 'var(--color-success)' : 'var(--color-border)',\r\n                            color: t.isPaid ? 'white' : 'var(--color-text-tertiary)',\r\n                            fontSize: '0.6rem', display: 'flex', alignItems: 'center', justifyContent: 'center',\r\n                            fontWeight: 'bold', border: t.isCurrent ? '2px solid var(--color-text-primary)' : 'none',\r\n                            opacity: t.isPaid || t.isCurrent ? 1 : 0.4\r\n                        }}>\r\n                            {t.label[0]}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n                <div style={{\r\n                    fontSize: '0.65rem', fontWeight: '800', padding: '3px 8px', borderRadius: '10px',\r\n                    background: isPaidThisMonth ? 'var(--color-success)' : 'var(--color-text-tertiary)',\r\n                    color: 'white', textTransform: 'uppercase'\r\n                }}>\r\n                    {isPaidThisMonth ? 'Pago' : 'Pendente'}\r\n                </div>\r\n            </div>\r\n\r\n            <div style={{ padding: '16px' }}>\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '16px' }}>\r\n                    <div>\r\n                        <div style={{ fontSize: '1.4rem', fontWeight: '800', color: 'var(--color-text-primary)' }}>\r\n                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(imovel.valor_aluguel)}\r\n                        </div>\r\n                        <h3 style={{ fontSize: '0.95rem', fontWeight: '600' }}>{imovel.nome}</h3>\r\n                    </div>\r\n                    <button\r\n                        onClick={() => setShowDeleteModal(true)}\r\n                        className=\"btn\"\r\n                        style={{\r\n                            background: 'var(--color-error)',\r\n                            color: 'white',\r\n                            border: '1px solid rgba(0,0,0,0.1)',\r\n                            padding: '6px',\r\n                            boxShadow: 'var(--shadow-sm)',\r\n                            display: 'flex',\r\n                            alignItems: 'center',\r\n                            gap: '4px'\r\n                        }}\r\n                        title=\"Ação Irreversível: Apagar imóvel e todos os registros relacionados\"\r\n                    >\r\n                        <AlertCircle size={14} />\r\n                        <Trash2 size={16} />\r\n                    </button>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1.5fr 1fr', gap: '8px', marginBottom: '8px' }}>\r\n                    {!isPaidThisMonth ? (\r\n                        <button onClick={() => setShowPaymentModal(true)} className=\"btn\" style={{ background: 'var(--color-success)', color: 'white', fontSize: '0.85rem' }}>\r\n                            <CheckCircle size={16} /> Receber {currentMonthName.slice(0, 3)}\r\n                        </button>\r\n                    ) : (\r\n                        <button\r\n                            disabled\r\n                            className=\"btn\"\r\n                            style={{ background: 'var(--color-surface-2)', color: 'var(--color-text-tertiary)', fontSize: '0.8rem', cursor: 'not-allowed', border: '1px solid var(--color-border)', flex: 1, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '4px' }}\r\n                            title=\"Pagamento já recebido este mês\"\r\n                        >\r\n                            <Lock size={14} /> Pago\r\n                        </button>\r\n                    )}\r\n                    <button onClick={() => setShowGastoModal(true)} className=\"btn\" style={{ background: 'var(--color-surface-2)', color: 'var(--color-text-primary)', border: '1px solid var(--color-border)', fontSize: '0.8rem' }}>\r\n                        <Plus size={16} /> Gasto\r\n                    </button>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px' }}>\r\n                    <Link href={`/properties/${imovel.id}`} className=\"btn\" style={{ background: 'var(--color-surface-2)', fontSize: '0.8rem', border: '1px solid var(--color-border)', flex: 1 }}>\r\n                        <Search size={16} /> Histórico\r\n                    </Link>\r\n                    <Link href={`/properties/${imovel.id}`} className=\"btn\" style={{ background: 'var(--color-surface-2)', fontSize: '0.8rem', border: '1px solid var(--color-border)', flex: 1 }}>\r\n                        <BarChart3 size={16} /> Relatório\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n\r\n            {/* QUICK GASTO MODAL */}\r\n            {showGastoModal && (\r\n                <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.5)', zIndex: 100, display: 'flex', alignItems: 'center', justifyContent: 'center', padding: '20px' }}>\r\n                    <div className=\"card\" style={{ width: '100%', maxWidth: '350px', background: 'white', padding: '20px' }}>\r\n                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '20px' }}>\r\n                            <h3 style={{ fontSize: '1.1rem' }}>Novo Gasto - {currentMonthName}</h3>\r\n                            <button onClick={() => setShowGastoModal(false)} style={{ background: 'none', border: 'none' }}><X size={20} /></button>\r\n                        </div>\r\n                        <form onSubmit={handleSaveGasto}>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"label\">Descrição</label>\r\n                                <input type=\"text\" className=\"input\" value={gastoDesc} onChange={e => setGastoDesc(e.target.value)} required placeholder=\"Ex: Reforma cano\" />\r\n                            </div>\r\n                            <div className=\"form-group\">\r\n                                <label className=\"label\">Valor (R$)</label>\r\n                                <input type=\"number\" step=\"0.01\" className=\"input\" value={gastoValor} onChange={e => setGastoValor(e.target.value)} required placeholder=\"0,00\" />\r\n                            </div>\r\n                            <button disabled={isSavingGasto} type=\"submit\" className=\"btn btn-primary btn-full\" style={{ marginTop: '10px' }}>\r\n                                {isSavingGasto ? 'Salvando...' : 'Salvar Gasto'}\r\n                            </button>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* DELETE CONFIRMATION MODAL */}\r\n            <DeleteConfirmModal\r\n                isOpen={showDeleteModal}\r\n                onClose={() => setShowDeleteModal(false)}\r\n                onConfirm={handleDeleteImovel}\r\n                itemName={imovel.nome}\r\n                itemType=\"Imóvel\"\r\n            />\r\n\r\n            {/* PAYMENT CONFIRMATION MODAL */}\r\n            <DeleteConfirmModal\r\n                isOpen={showPaymentModal}\r\n                onClose={() => setShowPaymentModal(false)}\r\n                onConfirm={handlePayment}\r\n                itemName={`${imovel.nome} (${currentMonthName}/${currentYear})`}\r\n                itemType=\"Gasto\" // Using Gasto type for a different color/context icon if needed, but the logic is same. \r\n            // Actually, I should have a generic modal, but let's use what we have or adjust.\r\n            // Re-think: \"Gasto\" has a specific icon. \r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\spreadsheet\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setNow' is assigned a value but never used.","line":14,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useFinancialData, type RentalSpreadsheetRow, type LoanSpreadsheetRow } from \"@/hooks/useFinancialData\";\r\nimport { ArrowLeft, Download, RefreshCw } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useState } from \"react\";\r\nimport { exportToExcel } from \"@/utils/exportUtils\";\r\n\r\n\r\nexport default function SpreadsheetPage() {\r\n    const { spreadsheet, loading } = useFinancialData();\r\n    const [activeTab, setActiveTab] = useState<'rentals' | 'loans'>('rentals');\r\n    const [filterActive, setFilterActive] = useState(true); // Default to Active Only\r\n    const [now, setNow] = useState(new Date());\r\n\r\n    if (loading) return <div className=\"p-8 text-center\">Carregando dados...</div>;\r\n\r\n    // --- FILTER LOGIC ---\r\n    const filteredRentals = spreadsheet.rentals;\r\n\r\n    const filteredLoans = spreadsheet.loans.filter(l => {\r\n        if (!filterActive) return true; // Show all\r\n        return l.status === 'Ativo' || l.status === 'Atrasado';\r\n    });\r\n\r\n    const currentData = activeTab === 'rentals' ? filteredRentals : filteredLoans;\r\n\r\n    // --- SNAPSHOT EXPORT ---\r\n    const handleExport = () => {\r\n        const formattedDate = now.toLocaleDateString('pt-BR').replace(/\\//g, '-');\r\n        const timestamp = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' }).replace(':', 'h');\r\n        const filename = `Relatorio_Financeiro_${formattedDate}_${timestamp}.xlsx`;\r\n\r\n        // Calculate period (from data if available, or just use current month as label)\r\n        // const periodLabel = activeTab === 'rentals' && filteredRentals.length > 0\r\n        //     ? `Janeiro-${now.getFullYear()}` // Simplified period for internal branding\r\n        //     : 'Geral';\r\n\r\n        const metadata = [\r\n            { label: 'Data da Exportação', value: now.toLocaleString('pt-BR') },\r\n            { label: 'Sistema', value: 'Gestão Patrimonial' },\r\n        ];\r\n\r\n        exportToExcel([\r\n            {\r\n                name: 'Imóveis',\r\n                data: filteredRentals.map(r => ({\r\n                    'Imóvel': r.property,\r\n                    'Mês/Ano': r.month,\r\n                    'Valor Aluguel': r.rentValue,\r\n                    'Status': r.status,\r\n                    'Data Pagamento': r.paymentDate,\r\n                    'Receita': r.revenue,\r\n                    'Gastos': r.expenses,\r\n                    'Lucro Líquido': r.netProfit\r\n                })),\r\n                metadata: [...metadata, { label: 'Tipo', value: 'Relatório de Aluguéis' }]\r\n            },\r\n            {\r\n                name: 'Empréstimos',\r\n                data: filteredLoans.map(l => ({\r\n                    'Cliente': l.client,\r\n                    'Vlr Emprestado': l.principal,\r\n                    'Taxa': l.rate,\r\n                    'Dias': l.days,\r\n                    'Juros': l.interest,\r\n                    'Total Receber': l.total,\r\n                    'Status': l.status,\r\n                    'Início': l.startDate,\r\n                    'Vencimento': l.dueDate,\r\n                    'Pago Em': l.paidDate\r\n                })),\r\n                metadata: [...metadata, { label: 'Tipo', value: 'Relatório de Empréstimos' }]\r\n            }\r\n        ], filename);\r\n    };\r\n\r\n    // --- TOTALS ---\r\n    const totalValue = currentData.reduce((acc: number, item) => {\r\n        if (activeTab === 'rentals') return acc + (('netProfit' in item ? (item.netProfit as number) : 0) || 0);\r\n        return acc + (('total' in item ? (item.total as number) : 0) || 0);\r\n    }, 0);\r\n\r\n    return (\r\n        <div className=\"container mx-auto p-4 max-w-6xl pb-24\">\r\n\r\n            {/* HEADER */}\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4\">\r\n                <div className=\"flex items-center gap-3\">\r\n                    <Link href=\"/\" className=\"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition\">\r\n                        <ArrowLeft size={20} className=\"text-gray-600\" />\r\n                    </Link>\r\n                    <div>\r\n                        <h1 className=\"text-2xl font-bold text-gray-800\">Planilha Geral</h1>\r\n                        <p className=\"text-xs text-gray-500 flex items-center gap-1\">\r\n                            <RefreshCw size={10} />\r\n                            {now.toLocaleString('pt-BR')}\r\n                            <span className=\"mx-1\">•</span>\r\n                            {currentData.length} registros\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                    <button\r\n                        onClick={handleExport}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium text-sm shadow-sm\"\r\n                    >\r\n                        <Download size={16} />\r\n                        Exportar Excel (.xlsx)\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* CONTROLS */}\r\n            <div className=\"flex flex-col sm:flex-row justify-between items-center bg-white p-2 rounded-xl shadow-sm border border-gray-100 mb-6\">\r\n                {/* TABS */}\r\n                <div className=\"flex gap-2\">\r\n                    <button\r\n                        onClick={() => setActiveTab('rentals')}\r\n                        className={`px-4 py-2 rounded-lg font-medium text-sm transition-all ${activeTab === 'rentals' ? 'bg-blue-50 text-blue-700' : 'text-gray-500 hover:bg-gray-50'}`}\r\n                    >\r\n                        Aluguéis\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setActiveTab('loans')}\r\n                        className={`px-4 py-2 rounded-lg font-medium text-sm transition-all ${activeTab === 'loans' ? 'bg-green-50 text-green-700' : 'text-gray-500 hover:bg-gray-50'}`}\r\n                    >\r\n                        Empréstimos\r\n                    </button>\r\n                </div>\r\n\r\n                {/* FILTERS */}\r\n                {activeTab === 'loans' && (\r\n                    <label className=\"flex items-center gap-2 cursor-pointer px-4 py-2\">\r\n                        <input\r\n                            type=\"checkbox\"\r\n                            checked={filterActive}\r\n                            onChange={e => setFilterActive(e.target.checked)}\r\n                            className=\"w-4 h-4 rounded text-blue-600 focus:ring-blue-500\"\r\n                        />\r\n                        <span className=\"text-sm text-gray-700\">Apenas Empréstimos Ativos</span>\r\n                    </label>\r\n                )}\r\n            </div>\r\n\r\n            {/* TOTALS SUMMARY */}\r\n            <div className=\"mb-4 bg-gray-50 p-4 rounded-xl border border-dashed border-gray-300 flex justify-between items-center\">\r\n                <span className=\"text-sm font-medium text-gray-500\">Total Listado (Estimativa)</span>\r\n                <span className=\"text-xl font-bold text-gray-800\">\r\n                    {totalValue.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                </span>\r\n            </div>\r\n\r\n            {/* CONTENT */}\r\n            <div className=\"bg-white border md:rounded-xl overflow-hidden shadow-sm\">\r\n                <div className=\"overflow-x-auto\">\r\n                    {activeTab === 'rentals' ? (\r\n                        <table className=\"w-full text-sm text-left\">\r\n                            <thead className=\"bg-gray-50 text-gray-600 font-medium border-b\">\r\n                                <tr>\r\n                                    <th className=\"px-4 py-3\">Imóvel</th>\r\n                                    <th className=\"px-4 py-3\">Mês/Ano</th>\r\n                                    <th className=\"px-4 py-3 text-right\">Valor Aluguel</th>\r\n                                    <th className=\"px-4 py-3 text-center\">Status</th>\r\n                                    <th className=\"px-4 py-3\">Data Pagto</th>\r\n                                    <th className=\"px-4 py-3 text-right\">Gastos</th>\r\n                                    <th className=\"px-4 py-3 text-right font-bold text-gray-800\">Lucro Líq.</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-gray-100\">\r\n                                {currentData.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan={7} className=\"px-4 py-8 text-center text-gray-400\">\r\n                                            Nenhum registro encontrado.\r\n                                        </td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    currentData.map((item, idx: number) => {\r\n                                        const r = item as RentalSpreadsheetRow;\r\n                                        return (\r\n                                            <tr key={idx} className=\"hover:bg-gray-50 transition\">\r\n                                                <td className=\"px-4 py-3 font-medium text-gray-800\">{r.property}</td>\r\n                                                <td className=\"px-4 py-3 text-gray-600\">{r.month || \"N/A\"}</td>\r\n                                                <td className=\"px-4 py-3 text-right text-gray-800\">\r\n                                                    {(r.rentValue || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-center\">\r\n                                                    <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${r.status === 'Pago' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'\r\n                                                        }`}>\r\n                                                        {r.status || \"N/A\"}\r\n                                                    </span>\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-gray-600 text-xs\">{r.paymentDate || \"N/A\"}</td>\r\n                                                <td className=\"px-4 py-3 text-right text-red-600\">\r\n                                                    - {(r.expenses || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-right font-bold text-blue-600\">\r\n                                                    {(r.netProfit || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                                                </td>\r\n                                            </tr>\r\n                                        );\r\n                                    })\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    ) : (\r\n                        <table className=\"w-full text-sm text-left\">\r\n                            <thead className=\"bg-gray-50 text-gray-600 font-medium border-b\">\r\n                                <tr>\r\n                                    <th className=\"px-4 py-3\">Cliente</th>\r\n                                    <th className=\"px-4 py-3 text-right\">Emprestado</th>\r\n                                    <th className=\"px-4 py-3 text-center\">Taxa</th>\r\n                                    <th className=\"px-4 py-3 text-center\">Dias</th>\r\n                                    <th className=\"px-4 py-3 text-right\">Juros Calc.</th>\r\n                                    <th className=\"px-4 py-3 text-right font-bold\">Total Receber</th>\r\n                                    <th className=\"px-4 py-3 text-center\">Status</th>\r\n                                    <th className=\"px-4 py-3 text-right\">Recebido Em</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody className=\"divide-y divide-gray-100\">\r\n                                {currentData.length === 0 ? (\r\n                                    <tr>\r\n                                        <td colSpan={8} className=\"px-4 py-8 text-center text-gray-400\">\r\n                                            Nenhum empréstimo encontrado.\r\n                                        </td>\r\n                                    </tr>\r\n                                ) : (\r\n                                    currentData.map((item, idx: number) => {\r\n                                        const l = item as LoanSpreadsheetRow;\r\n                                        return (\r\n                                            <tr key={idx} className=\"hover:bg-gray-50 transition\">\r\n                                                <td className=\"px-4 py-3 font-medium text-gray-800\">{l.client}</td>\r\n                                                <td className=\"px-4 py-3 text-right text-gray-600\">\r\n                                                    {(l.principal || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-center text-gray-500\">{l.rate || \"0%\"}</td>\r\n                                                <td className=\"px-4 py-3 text-center text-gray-500\">{l.days || 0}</td>\r\n                                                <td className=\"px-4 py-3 text-right text-green-600\">\r\n                                                    + {(l.interest || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-right font-bold text-gray-800\">\r\n                                                    {(l.total || 0).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-center\">\r\n                                                    <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${l.status === 'Recebido' ? 'bg-green-100 text-green-700' :\r\n                                                        l.status === 'Ativo' ? 'bg-blue-100 text-blue-700' : 'bg-red-100 text-red-700'\r\n                                                        }`}>\r\n                                                        {l.status}\r\n                                                    </span>\r\n                                                </td>\r\n                                                <td className=\"px-4 py-3 text-right text-xs text-gray-500\">{l.dateReceived || \"---\"}</td>\r\n                                            </tr>\r\n                                        );\r\n                                    })\r\n                                )}\r\n                            </tbody>\r\n                        </table>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"mt-4 text-center text-xs text-gray-400\">\r\n                * Valores baseados apenas em registros existentes. Itens apagados não aparecem.\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\BottomNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\DeleteConfirmModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\LoanCalculatorModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\ServiceWorkerRegister.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'href' is assigned a value but never used.","line":38,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\n\r\nexport default function ServiceWorkerRegister() {\r\n    useEffect(() => {\r\n        // 1. Register Service Worker with strict scope\r\n        if (\"serviceWorker\" in navigator) {\r\n            // Optional: Unregister old scopes if needed, but registering new one usually handles it.\r\n            // We register immediately as requested.\r\n            navigator.serviceWorker\r\n                .register(\"/sw.js\", { scope: \"/\" })\r\n                .then((registration) => {\r\n                    console.log(\"SW Registered with scope:\", registration.scope);\r\n                })\r\n                .catch((error) => {\r\n                    console.error(\"SW Registration failed:\", error);\r\n                });\r\n        }\r\n\r\n        // 2. iOS / Standalone Mode Handling\r\n        // \"Se estiver rodando como PWA... Ajustar layout\"\r\n        const isStandalone =\r\n            window.matchMedia(\"(display-mode: standalone)\").matches ||\r\n            (window.navigator as Navigator & { standalone?: boolean }).standalone === true;\r\n\r\n        if (isStandalone) {\r\n            // Add a class to html for specific PWA styling if needed\r\n            document.documentElement.classList.add(\"is-pwa\");\r\n\r\n            // Fix for iOS Safari opening links in new window (occasionally happens)\r\n            // We ensure internal links stay in the app.\r\n            // (Next.js Link usually handles this, but this is a safeguard for 'window.location' dependency mentioned)\r\n            document.addEventListener(\"click\", (e: MouseEvent) => {\r\n                const target = (e.target as HTMLElement).closest(\"a\");\r\n                if (!target) return;\r\n\r\n                const href = target.getAttribute(\"href\");\r\n\r\n                // internal link logic safeguard\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    return null;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\SystemHealthCheck.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\SystemHealthModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\ToastProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\context\\AppContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\context\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\hooks\\useFinancialData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\lib\\supabaseAdmin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\lib\\supabaseClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\utils\\exportUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]