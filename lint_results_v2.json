[{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\public\\sw.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\api\\cron\\keep-alive\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\api\\keep-alive\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\auth\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\[id]\\edit\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":95,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":95,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, use } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { ChevronLeft, Trash2, Save, User, DollarSign, Percent, Calendar, Phone } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Emprestimo } from \"@/types\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function EditLoanPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n    const router = useRouter();\r\n    const { emprestimos, atualizarEmprestimo, deletarEmprestimo } = useApp();\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const loan = emprestimos.find((l) => l.id === id) || null;\r\n\r\n    if (!loan) {\r\n        return (\r\n            <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>\r\n                <p>Carregando empréstimo...</p>\r\n                <Link href=\"/loans\" className=\"btn\" style={{ marginTop: '16px' }}>Voltar</Link>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (loan.status === 'pago') {\r\n        return (\r\n            <div className=\"container\">\r\n                <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-lg)', gap: 'var(--space-sm)' }}>\r\n                    <Link href={`/loans/${id}`} style={{ padding: '8px', marginLeft: '-8px' }}>\r\n                        <ChevronLeft size={24} />\r\n                    </Link>\r\n                    <h1 style={{ marginTop: '-4px' }}>Empréstimo Encerrado</h1>\r\n                </header>\r\n                <div className=\"card shadow-sm\" style={{ textAlign: 'center', padding: 'var(--space-xl)' }}>\r\n                    <p style={{ color: 'var(--color-text-secondary)', marginBottom: 'var(--space-lg)' }}>\r\n                        Este empréstimo já foi marcado como PAGO e não pode ser editado.\r\n                    </p>\r\n                    <Link href={`/loans/${id}`} className=\"btn btn-full\">Visualizar Detalhes</Link>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main style={{ minHeight: '100vh', background: 'var(--color-background)', padding: 'var(--space-md) 0' }}>\r\n            <div className=\"container\" style={{ maxWidth: '800px' }}>\r\n                <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-xl)', gap: 'var(--space-sm)' }}>\r\n                    <Link href={`/loans/${id}`} style={{\r\n                        padding: '10px',\r\n                        marginLeft: '-10px',\r\n                        color: 'var(--color-text-secondary)',\r\n                        transition: 'color 0.2s'\r\n                    }} className=\"hover-primary\">\r\n                        <ChevronLeft size={24} />\r\n                    </Link>\r\n                    <h1 style={{ fontSize: '1.75rem', fontWeight: 800, letterSpacing: '-0.03em' }}>Editar Empréstimo</h1>\r\n                </header>\r\n\r\n                <LoanEditForm\r\n                    loan={loan}\r\n                    onSubmit={atualizarEmprestimo}\r\n                    onDeleteRequest={() => setIsDeleteModalOpen(true)}\r\n                    onSuccess={() => router.push(`/loans/${id}`)}\r\n                />\r\n\r\n                <DeleteConfirmModal\r\n                    isOpen={isDeleteModalOpen}\r\n                    onClose={() => setIsDeleteModalOpen(false)}\r\n                    onConfirm={async () => {\r\n                        await deletarEmprestimo(loan.id);\r\n                        router.push(\"/loans\");\r\n                    }}\r\n                    itemName={loan.cliente_nome}\r\n                    itemType=\"Empréstimo\"\r\n                />\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n\r\nfunction LoanEditForm({\r\n    loan,\r\n    onSubmit,\r\n    onSuccess,\r\n    onDeleteRequest\r\n}: {\r\n    loan: Emprestimo,\r\n    onSubmit: (id: string, updates: Partial<Emprestimo>) => Promise<void>,\r\n    onSuccess: () => void,\r\n    onDeleteRequest: () => void\r\n}) {\r\n    const router = useRouter();\r\n    const [formData, setFormData] = useState({\r\n        borrowerName: loan.cliente_nome,\r\n        principal: loan.valor_emprestado.toString().replace('.', ','),\r\n        interestRate: loan.juros_mensal.toString().replace('.', ','),\r\n        phone: loan.telefone || \"\",\r\n        startDate: loan.data_inicio,\r\n        dueDate: loan.data_fim\r\n    });\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        await onSubmit(loan.id, {\r\n            cliente_nome: formData.borrowerName,\r\n            valor_emprestado: parseFloat(formData.principal.replace(',', '.')),\r\n            juros_mensal: parseFloat(formData.interestRate.replace(',', '.')),\r\n            telefone: formData.phone,\r\n            data_inicio: formData.startDate,\r\n            data_fim: formData.dueDate\r\n        });\r\n        onSuccess();\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-lg)' }}>\r\n\r\n            {/* Seção 1: Dados do Tomador */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <User size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Dados do Tomador</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Nome Completo</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.borrowerName}\r\n                            onChange={(e) => setFormData({ ...formData, borrowerName: e.target.value })}\r\n                            placeholder=\"Nome do cliente\"\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">\r\n                            <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                <Phone size={12} /> Telefone\r\n                            </div>\r\n                        </label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.phone}\r\n                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                            placeholder=\"(00) 00000-0000\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Seção 2: Detalhes do Empréstimo */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <DollarSign size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Condições Financeiras</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: 'var(--space-lg)' }}>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">Valor Emprestado</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"input\"\r\n                                style={{ fontSize: '1.25rem', fontWeight: 700, color: 'var(--color-primary)' }}\r\n                                value={formData.principal}\r\n                                onChange={(e) => setFormData({ ...formData, principal: e.target.value })}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Percent size={12} /> Taxa Mensal\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"input\"\r\n                                value={formData.interestRate}\r\n                                onChange={(e) => setFormData({ ...formData, interestRate: e.target.value })}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Calendar size={12} /> Data de Início\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"input\"\r\n                                value={formData.startDate}\r\n                                onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Calendar size={12} /> Data de Vencimento\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"date\"\r\n                                className=\"input\"\r\n                                value={formData.dueDate}\r\n                                onChange={(e) => setFormData({ ...formData, dueDate: e.target.value })}\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Ações */}\r\n            <div style={{ marginTop: 'var(--space-lg)', display: 'flex', flexDirection: 'column', gap: 'var(--space-md)' }}>\r\n                <button type=\"submit\" className=\"btn btn-success\" style={{ height: '56px', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)' }}>\r\n                    <Save size={20} style={{ marginRight: '10px' }} />\r\n                    <span style={{ fontWeight: 700 }}>Salvar Alterações</span>\r\n                </button>\r\n\r\n                <button\r\n                    type=\"button\"\r\n                    onClick={onDeleteRequest}\r\n                    className=\"btn btn-danger-outline\"\r\n                    style={{ height: '52px', borderRadius: '12px', marginTop: '12px' }}\r\n                >\r\n                    <Trash2 size={18} style={{ marginRight: '8px' }} /> Apagar Registro\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\[id]\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Emprestimo' is defined but never used.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, use } from \"react\";\r\nimport { ChevronLeft, AlertTriangle, UserX, CheckCircle, Clock } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Emprestimo } from \"@/types\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function LoanDetailsPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n    const { emprestimos, deletarEmprestimo } = useApp();\r\n    const router = useRouter();\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const emprestimo = emprestimos.find((l) => l.id === id) || null;\r\n\r\n    if (!emprestimo) return <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>Carregando...</div>;\r\n\r\n    const isPaid = emprestimo.status === 'pago';\r\n\r\n    // Stats\r\n    const stats = {\r\n        daysTotal: emprestimo.dias_contratados,\r\n        displayDuration: `${emprestimo.dias_contratados} dias`,\r\n        totalReceivable: emprestimo.valor_emprestado + emprestimo.juros_total_contratado,\r\n        interestOnly: emprestimo.juros_total_contratado,\r\n        // Overdue check\r\n        isOverdue: false\r\n    };\r\n\r\n    if (!isPaid) {\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n        const due = new Date(emprestimo.data_fim + 'T12:00:00');\r\n        due.setHours(0, 0, 0, 0);\r\n        stats.isOverdue = today > due;\r\n    }\r\n\r\n    const startDateStr = new Date(emprestimo.data_inicio + 'T12:00:00').toLocaleDateString('pt-BR');\r\n    const dueDateStr = new Date(emprestimo.data_fim + 'T12:00:00').toLocaleDateString('pt-BR');\r\n    const paymentDateStr = emprestimo.data_pagamento ? new Date(emprestimo.data_pagamento).toLocaleDateString('pt-BR') : '-';\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-lg)', gap: 'var(--space-sm)' }}>\r\n                <Link href=\"/loans\" style={{ padding: '8px', marginLeft: '-8px' }}>\r\n                    <ChevronLeft size={24} />\r\n                </Link>\r\n                <div>\r\n                    <h1 style={{ marginTop: '-4px' }}>Detalhes do Empréstimo</h1>\r\n                </div>\r\n            </header>\r\n\r\n            <div className=\"card\">\r\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 'var(--space-md)' }}>\r\n                    <div>\r\n                        <h2 style={{ fontSize: '1.25rem', marginBottom: '4px' }}>\r\n                            {emprestimo.cliente_nome}\r\n                        </h2>\r\n                        <p style={{ fontSize: '0.9rem', color: 'var(--color-text-secondary)' }}>Criado em {startDateStr}</p>\r\n                    </div>\r\n                    <div>\r\n                        {isPaid ? (\r\n                            <div style={{ textAlign: 'right' }}>\r\n                                <span style={{ fontSize: '0.8rem', background: 'var(--color-success)', color: 'white', padding: '4px 8px', borderRadius: '4px', display: 'flex', alignItems: 'center', gap: '4px', justifyContent: 'flex-end' }}>\r\n                                    <CheckCircle size={12} /> ENCERRADO\r\n                                </span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-success)', marginTop: '4px' }}>\r\n                                    Em {paymentDateStr}\r\n                                </div>\r\n                            </div>\r\n                        ) : stats.isOverdue ? (\r\n                            <span style={{ fontSize: '0.8rem', background: 'var(--color-danger)', color: 'white', padding: '4px 8px', borderRadius: '4px', display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                <AlertTriangle size={14} /> VENCIDO\r\n                            </span>\r\n                        ) : (\r\n                            <span style={{ fontSize: '0.8rem', background: 'var(--color-primary)', color: 'white', padding: '4px 8px', borderRadius: '4px' }}>ATIVO</span>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Timeline */}\r\n                <div style={{ margin: 'var(--space-lg) 0', padding: '10px 0', borderTop: '1px dashed var(--color-border)', borderBottom: '1px dashed var(--color-border)' }}>\r\n                    <h3 style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)', marginBottom: '10px', textTransform: 'uppercase', letterSpacing: '1px' }}>Linha do Tempo</h3>\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', position: 'relative', fontSize: '0.8rem' }}>\r\n                        {/* Line */}\r\n                        <div style={{ position: 'absolute', top: '12px', left: '10px', right: '10px', height: '2px', background: 'var(--color-border)', zIndex: 0 }}></div>\r\n\r\n                        {/* Start Node */}\r\n                        <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                            <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-surface-2)', border: '2px solid var(--color-text-tertiary)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                <Clock size={12} color=\"var(--color-text-tertiary)\" />\r\n                            </div>\r\n                            <span style={{ fontWeight: 600 }}>Início</span>\r\n                            <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{startDateStr}</div>\r\n                        </div>\r\n\r\n                        {/* Middle/End Node - Dynamic */}\r\n                        {isPaid ? (\r\n                            <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                                <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-success)', border: '2px solid var(--color-success)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                    <CheckCircle size={14} color=\"white\" />\r\n                                </div>\r\n                                <span style={{ fontWeight: 600, color: 'var(--color-success)' }}>Pago</span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{paymentDateStr}</div>\r\n                            </div>\r\n                        ) : stats.isOverdue ? (\r\n                            <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                                <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-danger)', border: '2px solid var(--color-danger)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                    <AlertTriangle size={14} color=\"white\" />\r\n                                </div>\r\n                                <span style={{ fontWeight: 600, color: 'var(--color-danger)' }}>Vencido</span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{dueDateStr}</div>\r\n                            </div>\r\n                        ) : (\r\n                            <div style={{ zIndex: 1, textAlign: 'center', background: 'var(--color-bg)', padding: '0 5px' }}>\r\n                                <div style={{ width: '24px', height: '24px', borderRadius: '50%', background: 'var(--color-surface-2)', border: '2px solid var(--color-primary)', display: 'flex', alignItems: 'center', justifyContent: 'center', margin: '0 auto 4px' }}>\r\n                                    <Clock size={12} color=\"var(--color-primary)\" />\r\n                                </div>\r\n                                <span style={{ fontWeight: 600 }}>Previsto</span>\r\n                                <div style={{ fontSize: '0.7rem', color: 'var(--color-text-active)' }}>{dueDateStr}</div>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 'var(--space-lg)' }}>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Valor Emprestado</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\r\n                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(emprestimo.valor_emprestado)}\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Juros Mensal</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\r\n                            {emprestimo.juros_mensal}% a.m.\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Duração Contratada</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\r\n                            {stats.displayDuration}\r\n                        </div>\r\n                    </div>\r\n                    <div>\r\n                        <label style={{ display: 'block', fontSize: '0.8rem', color: 'var(--color-text-secondary)', marginBottom: '4px' }}>Lucro Garantido</label>\r\n                        <div style={{ fontSize: '1.1rem', fontWeight: '600', color: 'var(--color-success)' }}>\r\n                            + {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(stats.interestOnly)}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{ background: 'var(--color-surface-2)', padding: '16px', borderRadius: '8px', marginTop: 'var(--space-lg)' }}>\r\n                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>\r\n                        <span style={{ fontWeight: '600' }}>Total {isPaid ? 'Pago' : 'a Receber'}</span>\r\n                        <span style={{ fontWeight: '700', fontSize: '1.2rem', color: 'var(--color-primary)' }}>\r\n                            {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(stats.totalReceivable)}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Admin Actions: Always available */}\r\n            <div style={{ marginTop: 'var(--space-xl)' }}>\r\n                <h3 style={{ fontSize: '0.9rem', marginBottom: 'var(--space-md)', color: 'var(--color-text-secondary)' }}>Ações de Controle</h3>\r\n                <button\r\n                    onClick={() => setIsDeleteModalOpen(true)}\r\n                    className=\"btn btn-full\"\r\n                    style={{ background: 'transparent', border: '1px solid var(--color-danger)', color: 'var(--color-danger)', justifyContent: 'center' }}\r\n                >\r\n                    <UserX size={18} style={{ marginRight: '8px' }} /> Apagar Empréstimo\r\n                </button>\r\n            </div>\r\n\r\n            <DeleteConfirmModal\r\n                isOpen={isDeleteModalOpen}\r\n                onClose={() => setIsDeleteModalOpen(false)}\r\n                onConfirm={async () => {\r\n                    await deletarEmprestimo(emprestimo.id);\r\n                    router.push(\"/loans\");\r\n                }}\r\n                itemName={emprestimo.cliente_nome}\r\n                itemType=\"Empréstimo\"\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\loans\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentYear' is assigned a value but never used.","line":106,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":106,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentMonth' is assigned a value but never used.","line":107,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":107,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport Link from \"next/link\";\nimport { ArrowRight, Wallet, Building, RefreshCw, AlertTriangle, CheckCircle, Table, Download, LogOut, ShieldCheck } from \"lucide-react\";\nimport { useApp } from \"@/context/AppContext\";\nimport { useAuth } from \"@/context/AuthContext\";\nimport { useState, useEffect } from \"react\";\nimport { useToast } from \"@/components/ToastProvider\";\nimport { useFinancialData } from \"@/hooks/useFinancialData\";\nimport { exportToCSV } from \"@/utils/exportUtils\";\nimport { supabase } from \"@/lib/supabaseClient\";\nimport SystemHealthModal from \"@/components/SystemHealthModal\";\n\n\nexport default function Home() {\n  // V1.0.1 - Force Deploy for Env Vars\n  const { imoveis, emprestimos, imoveisPagamentos, refreshData, loading } = useApp();\n  const { showToast } = useToast();\n  const { signOut } = useAuth(); // Auth Hook\n\n  // --- STRICT DATA INTEGRITY & CALCULATION HOOK ---\n  const { dashboard, spreadsheet } = useFinancialData();\n  const {\n    rentalRevenue,\n    rentalNetProfit,\n    loanRevenue,\n    totalLoanInterestContracted,\n  } = dashboard;\n\n  // Local state for time and formatting\n  const [now, setNow] = useState(new Date());\n  const [refreshKey, setRefreshKey] = useState(0);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  // Health Check State\n  const [isHealthModalOpen, setIsHealthModalOpen] = useState(false);\n  const [isCheckingHealth, setIsCheckingHealth] = useState(false);\n  const [healthData, setHealthData] = useState<{\n    supabase: boolean;\n    lastHeartbeat: string | null;\n    isHealthy: boolean;\n    checkedAt: string;\n  } | null>(null);\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setNow(new Date());\n    }, 1000 * 60);\n    return () => clearInterval(timer);\n  }, []);\n\n  const handleRefresh = async () => {\n    setIsRefreshing(true);\n    await refreshData();\n    setTimeout(() => {\n      setRefreshKey(prev => prev + 1);\n      setNow(new Date());\n      setIsRefreshing(false);\n      showToast(\"Painel atualizado e recalculado\", \"success\");\n    }, 500);\n  };\n\n  const handleCheckHealth = async () => {\n    setIsCheckingHealth(true);\n    setIsHealthModalOpen(true);\n\n    try {\n      // 1. Test Supabase Connection (Read-only)\n      const { data, error } = await supabase\n        .from('system_health')\n        .select('last_ping_at')\n        .eq('id', '00000000-0000-0000-0000-000000000001')\n        .single();\n\n      const supabaseConnected = !error;\n      const lastHeartbeat = data?.last_ping_at || null;\n\n      // 2. Determine Health\n      // Healthy if connected AND heartbeat is < 26 hours old (buffer over 24h)\n      let isHealthy = supabaseConnected && !!lastHeartbeat;\n      if (lastHeartbeat) {\n        const diff = Date.now() - new Date(lastHeartbeat).getTime();\n        if (diff > 26 * 60 * 60 * 1000) isHealthy = false;\n      }\n\n      setHealthData({\n        supabase: supabaseConnected,\n        lastHeartbeat,\n        isHealthy,\n        checkedAt: new Date().toISOString()\n      });\n\n    } catch (err) {\n      console.error(\"Health check failed:\", err);\n      setHealthData({\n        supabase: false,\n        lastHeartbeat: null,\n        isHealthy: false,\n        checkedAt: new Date().toISOString()\n      });\n    } finally {\n      setIsCheckingHealth(false);\n    }\n  };\n\n  const currentYear = now.getFullYear();\n  const currentMonth = now.getMonth();\n  // Fixed Month Ref for DB comparison (YYYY-MM-01)\n\n  const monthName = now.toLocaleString('pt-BR', { month: 'long', year: 'numeric' });\n  const timeStr = now.toLocaleString('pt-BR', { hour: '2-digit', minute: '2-digit' });\n\n  // EXPORT HANDLER\n  const handleExportDashboard = () => {\n    const formattedDate = now.toISOString().split('T')[0].split('-').reverse().join('-');\n    const formattedTime = now.toTimeString().split(' ')[0].replace(/:/g, '-').substring(0, 5);\n    const filename = `financeiro_${formattedDate}_${formattedTime}.csv`;\n\n    exportToCSV(spreadsheet.rentals, filename);\n    showToast(\"Download da planilha iniciado\", \"success\");\n  };\n\n  // --- ALERTS LOGIC (STRICT - RENTAL & LOANS) ---\n  const alerts: { id: string; type: 'warning' | 'danger' | 'info'; title: string; subtitle: string; propertyId: string; sortScore: number }[] = [];\n  let pendingRentalsCount = 0;\n\n  // 1. Get Today in Brazil (UTC-3)\n  const brOffset = -3;\n  const nowBr = new Date(new Date().getTime() + (brOffset * 60 * 60 * 1000) + (new Date().getTimezoneOffset() * 60 * 1000));\n  const todayDay = nowBr.getDate();\n  const currentMonthNum = nowBr.getMonth();\n  const currentYearNum = nowBr.getFullYear();\n\n  // Unified Month Ref for current check\n  const currentMesRefBr = `${currentYearNum}-${String(currentMonthNum + 1).padStart(2, '0')}-01`;\n\n  // Rental Alerts\n  imoveis.filter(p => p.ativo).forEach(imovel => {\n    const isPaidCurrentMonth = imoveisPagamentos.some(p => {\n      return p.imovel_id === imovel.id && p.status === 'pago' && p.mes_ref === currentMesRefBr;\n    });\n\n    const dueDay = imovel.dia_pagamento || 10;\n\n    if (!isPaidCurrentMonth) {\n      pendingRentalsCount++;\n      // Check current month due date\n      const dueDate = new Date(currentYearNum, currentMonthNum, dueDay, 12, 0, 0);\n      const formattedDueDate = dueDate.toLocaleDateString('pt-BR');\n      const diffDays = dueDay - todayDay;\n\n      if (diffDays < 0) {\n        alerts.push({\n          id: `prop-${imovel.id}`,\n          type: 'danger',\n          title: 'Aluguel Vencido',\n          subtitle: `${imovel.nome} - Venceu em ${formattedDueDate}`,\n          propertyId: imovel.id,\n          sortScore: 100\n        });\n      } else if (diffDays <= 3) {\n        const daysLabel = diffDays === 0 ? 'vence hoje' : diffDays === 1 ? 'vence em 1 dia' : `vence em ${diffDays} dias`;\n        alerts.push({\n          id: `prop-${imovel.id}`,\n          type: 'warning',\n          title: diffDays === 0 ? 'Vence Hoje' : 'Próximo do Vencimento',\n          subtitle: `${imovel.nome} ${formattedDueDate.slice(0, 5)} (${daysLabel})`,\n          propertyId: imovel.id,\n          sortScore: 50\n        });\n      }\n    } else {\n      // LOOKAHEAD: Current month is paid, check next month\n      const nextMonthDate = new Date(currentYearNum, currentMonthNum + 1, 1, 12, 0, 0);\n      const nextMonthNum = nextMonthDate.getMonth();\n      const nextYearNum = nextMonthDate.getFullYear();\n\n      const nextDueDate = new Date(nextYearNum, nextMonthNum, dueDay, 12, 0, 0);\n      const formattedNextDueDate = nextDueDate.toLocaleDateString('pt-BR');\n\n      // Calculate diff between Next Due Date and Today\n      const diffTime = nextDueDate.getTime() - nowBr.getTime();\n      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n      if (diffDays >= 0 && diffDays <= 3) {\n        const daysLabel = diffDays === 0 ? 'vence hoje' : diffDays === 1 ? 'vence em 1 dia' : `vence em ${diffDays} dias`;\n        alerts.push({\n          id: `prop-${imovel.id}-next`,\n          type: 'warning',\n          title: 'Próximo Vencimento',\n          subtitle: `${imovel.nome} ${formattedNextDueDate.slice(0, 5)} (${daysLabel})`,\n          propertyId: imovel.id,\n          sortScore: 45 // Slightly lower than current month upcoming\n        });\n      }\n    }\n  });\n\n  // Loan Alerts\n  emprestimos.filter(l => l.status === 'ativo' && l.data_fim).forEach(loan => {\n    if (!loan.data_fim) return;\n    const due = new Date(loan.data_fim + 'T12:00:00');\n    due.setHours(0, 0, 0, 0);\n    const today = new Date(nowBr);\n    today.setHours(0, 0, 0, 0);\n\n    const diffTime = due.getTime() - today.getTime();\n    const loanDiffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n    if (loanDiffDays < 0) {\n      alerts.push({\n        id: `loan-${loan.id}`,\n        type: 'danger',\n        title: 'Empréstimo Atrasado',\n        subtitle: `${loan.cliente_nome}`,\n        propertyId: `/loans/${loan.id}`,\n        sortScore: 90 // Below rent overdue\n      });\n    } else if (loanDiffDays <= 3) {\n      alerts.push({\n        id: `loan-${loan.id}`,\n        type: 'warning',\n        title: loanDiffDays === 0 ? 'Vence Hoje' : 'Empréstimo Vencendo',\n        subtitle: `${loan.cliente_nome} - ${due.toLocaleDateString('pt-BR')}`,\n        propertyId: `/loans/${loan.id}`,\n        sortScore: 40\n      });\n    }\n  });\n\n  // Sort: Danger (higher score) first\n  alerts.sort((a, b) => b.sortScore - a.sortScore);\n\n  const totalNetProfit = rentalNetProfit + totalLoanInterestContracted;\n\n  return (\n    <div className=\"container\" key={refreshKey} style={{ maxWidth: '800px', margin: '0 auto' }}>\n      {loading ? (\n        <div style={{ display: 'flex', justifyContent: 'center', paddingTop: '50px' }}>Carregando...</div>\n      ) : (\n        <>\n          {/* HEADER: Context & Verification */}\n          <header style={{\n            marginBottom: 'var(--space-lg)',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n          }}>\n            <div>\n              <div style={{ fontSize: '0.75rem', textTransform: 'uppercase', letterSpacing: '1px', fontWeight: 'bold', color: 'var(--color-primary)', display: 'flex', alignItems: 'center', gap: '6px', background: 'rgba(var(--color-primary-rgb), 0.1)', padding: '4px 8px', borderRadius: '4px', width: 'fit-content', marginBottom: '8px' }}>\n                <CheckCircle size={10} /> App Financeiro Pessoal\n              </div>\n              <div style={{ fontSize: '1.2rem', fontWeight: 'bold' }}>Dashboard</div>\n              <div style={{ fontSize: '0.85rem', color: 'var(--color-text-secondary)' }}>{monthName} • {timeStr}</div>\n            </div>\n\n            <div style={{ textAlign: 'right' }}>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '6px', justifyContent: 'flex-end', marginBottom: '8px' }}>\n                <span style={{ fontSize: '0.75rem', fontWeight: '600', color: isRefreshing ? 'var(--color-warning)' : 'var(--color-success)', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                  {isRefreshing ? <RefreshCw size={10} className=\"spin-anim\" /> : <CheckCircle size={10} />}\n                  {isRefreshing ? 'Atualizando...' : 'Dados Atualizados'}\n                </span>\n              </div>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '12px', justifyContent: 'flex-end', flexWrap: 'wrap' }}>\n                <div style={{ display: 'flex', gap: '12px', alignItems: 'center' }}>\n                  <button onClick={handleCheckHealth} style={{ fontSize: '0.8rem', color: 'var(--color-text-primary)', background: 'var(--color-surface-2)', border: '1px solid var(--color-border)', borderRadius: '4px', padding: '4px 8px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '4px' }}>\n                    <ShieldCheck size={12} color=\"var(--color-primary)\" /> Verificar Sistema\n                  </button>\n                  <button onClick={handleRefresh} style={{ fontSize: '0.8rem', color: 'var(--color-primary)', background: 'none', border: 'none', cursor: 'pointer', textDecoration: 'underline' }}>\n                    Forçar Atualização\n                  </button>\n                </div>\n                <button onClick={signOut} style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)', background: 'none', border: 'none', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '4px', borderLeft: '1px solid var(--color-border)', paddingLeft: '12px' }}>\n                  <LogOut size={14} /> Sair\n                </button>\n              </div>\n            </div>\n          </header>\n\n          {/* MAIN INDICATOR */}\n          <div className=\"card\" style={{ background: 'var(--color-primary)', color: 'white', marginBottom: 'var(--space-xl)', textAlign: 'center', padding: '32px' }}>\n            <div style={{ fontSize: '0.9rem', opacity: 0.9, marginBottom: '8px', textTransform: 'uppercase' }}>Lucro Líquido Geral Estimado</div>\n            <div style={{ fontSize: '2.5rem', fontWeight: '800' }}>\n              {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalNetProfit)}\n            </div>\n            <div style={{ fontSize: '0.8rem', opacity: 0.8, marginTop: '8px' }}>\n              Considerando aluguéis e juros contratados\n            </div>\n          </div>\n\n\n          {/* --- BLOCK 1: ALUGUÉIS --- */}\n          <section style={{ marginBottom: 'var(--space-xl)' }}>\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-md)' }}>\n              <h2 style={{ fontSize: '1.1rem', display: 'flex', alignItems: 'center', gap: '8px', fontWeight: '700' }}>\n                <Building size={20} color=\"var(--color-primary)\" /> Imóveis\n              </h2>\n              <Link href=\"/properties\" style={{ fontSize: '0.85rem', color: 'var(--color-primary)' }}>Gerenciar</Link>\n            </div>\n\n            <Link href=\"/properties\" className=\"card\" style={{ display: 'block', borderLeft: '4px solid var(--color-primary)', textDecoration: 'none', transition: 'transform 0.1s' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <div>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-secondary)' }}>Lucro Líquido (Mês)</div>\n                  <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--color-text-primary)' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(rentalNetProfit)}\n                  </div>\n                </div>\n                <div style={{ textAlign: 'right' }}>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)' }}>Receita Bruta</div>\n                  <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(rentalRevenue)}\n                  </div>\n                </div>\n              </div>\n\n              {pendingRentalsCount > 0 && (\n                <div style={{ marginTop: '12px', paddingTop: '12px', borderTop: '1px solid var(--color-border-subtle)', color: 'var(--color-warning-dark)', fontSize: '0.85rem', display: 'flex', alignItems: 'center', gap: '6px' }}>\n                  <AlertTriangle size={14} /> {pendingRentalsCount} aluguéis pendentes este mês\n                </div>\n              )}\n            </Link>\n          </section>\n\n          {/* --- BLOCK 2: EMPRÉSTIMOS --- */}\n          <section style={{ marginBottom: 'var(--space-xl)' }}>\n            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: 'var(--space-md)' }}>\n              <h2 style={{ fontSize: '1.1rem', display: 'flex', alignItems: 'center', gap: '8px', fontWeight: '700' }}>\n                <Wallet size={20} color=\"var(--color-success)\" /> Empréstimos\n              </h2>\n              <Link href=\"/loans\" style={{ fontSize: '0.85rem', color: 'var(--color-primary)' }}>Gerenciar</Link>\n            </div>\n\n            <Link href=\"/loans\" className=\"card\" style={{ display: 'block', borderLeft: '4px solid var(--color-success)', textDecoration: 'none' }}>\n              <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <div>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-secondary)' }}>Lucro Juros (Total Contratado)</div>\n                  <div style={{ fontSize: '1.5rem', fontWeight: '700', color: 'var(--color-text-primary)' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalLoanInterestContracted)}\n                  </div>\n                </div>\n                <div style={{ textAlign: 'right' }}>\n                  <div style={{ fontSize: '0.8rem', color: 'var(--color-text-tertiary)' }}>Valor a Receber</div>\n                  <div style={{ fontSize: '1.1rem', fontWeight: '600' }}>\n                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(loanRevenue)}\n                  </div>\n                </div>\n              </div>\n            </Link>\n          </section>\n\n          {/* --- QUICK ACTIONS & ALERTS (VISUAL UPDATE: STACKED & NEUTRAL) --- */}\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-xl)', marginBottom: 'var(--space-xl)' }}>\n\n            {/* ALERTS SECTION (Conditional) */}\n            {alerts.length > 0 && (\n              <section>\n                <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '12px' }}>\n                  <h3 style={{ fontSize: '0.9rem', color: 'var(--color-text-secondary)', textTransform: 'uppercase', display: 'flex', alignItems: 'center', gap: '6px' }}>\n                    <AlertTriangle size={16} /> Atenção Necessária\n                  </h3>\n                </div>\n                <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>\n                  {alerts.map(alert => (\n                    <Link href={alert.propertyId.startsWith('/') ? alert.propertyId : `/properties/${alert.propertyId}`} key={alert.id} className=\"card\" style={{\n                      display: 'flex', alignItems: 'center', justifyContent: 'space-between',\n                      border: '1px solid var(--color-border)',\n                      // NEUTRAL/LIGHT BORDER - No heavy red/orange\n                      borderLeft: `4px solid ${alert.type === 'danger' ? 'var(--color-text-secondary)' : 'var(--color-text-tertiary)'}`,\n                      background: 'var(--color-surface-1)',\n                      padding: '16px 20px',\n                      textDecoration: 'none',\n                      boxShadow: 'none'\n                    }}>\n                      <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>\n                        {/* Icon Container - Provides the color signal without overwhelming */}\n                        <div style={{\n                          color: alert.type === 'danger' ? 'var(--color-danger)' : 'var(--color-warning)',\n                          background: alert.type === 'danger' ? 'rgba(var(--color-danger-rgb), 0.1)' : 'rgba(var(--color-warning-rgb), 0.1)',\n                          padding: '10px', borderRadius: '50%', display: 'flex', alignItems: 'center', justifyItems: 'center'\n                        }}>\n                          <AlertTriangle size={20} />\n                        </div>\n                        <div>\n                          <div style={{ fontWeight: '600', color: 'var(--color-text-primary)', fontSize: '0.95rem' }}>{alert.title}</div>\n                          <div style={{ fontSize: '0.85rem', color: 'var(--color-text-secondary)' }}>{alert.subtitle}</div>\n                        </div>\n                      </div>\n                      <ArrowRight size={18} color=\"var(--color-text-tertiary)\" />\n                    </Link>\n                  ))}\n                </div>\n              </section>\n            )}\n\n            {/* QUICK ACTIONS (ALWAYS LARGE, FIXED LAYOUT) */}\n            <section>\n              <h3 style={{ fontSize: '0.9rem', color: 'var(--color-text-secondary)', marginBottom: '12px', textTransform: 'uppercase' }}>Ações Rápidas</h3>\n              <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>\n                <Link href=\"/spreadsheet\" className=\"btn\" style={{\n                  background: 'var(--color-surface-2)',\n                  color: 'var(--color-text-primary)',\n                  flexDirection: 'column',\n                  padding: '24px',\n                  gap: '12px',\n                  height: '100%',\n                  justifyContent: 'center',\n                  border: '1px solid var(--color-border)',\n                  borderRadius: 'var(--radius-md)',\n                  minHeight: '120px' // Ensure large fixed target\n                }}>\n                  <Table size={32} strokeWidth={1.5} />\n                  <span style={{ fontSize: '0.9rem', fontWeight: '600' }}>Planilha Geral</span>\n                </Link>\n\n                <button onClick={handleExportDashboard} className=\"btn\" style={{\n                  background: 'var(--color-surface-2)',\n                  color: 'var(--color-text-primary)',\n                  flexDirection: 'column',\n                  padding: '24px',\n                  gap: '12px',\n                  height: '100%',\n                  justifyContent: 'center',\n                  border: '1px solid var(--color-border)',\n                  borderRadius: 'var(--radius-md)',\n                  minHeight: '120px' // Ensure large fixed target\n                }}>\n                  <Download size={32} strokeWidth={1.5} />\n                  <span style={{ fontSize: '0.9rem', fontWeight: '600' }}>Exportar CSV</span>\n                </button>\n              </div>\n            </section>\n          </div>\n\n        </>\n      )}\n\n      <SystemHealthModal\n        isOpen={isHealthModalOpen}\n        onClose={() => setIsHealthModalOpen(false)}\n        isLoading={isCheckingHealth}\n        healthData={healthData}\n      />\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\[id]\\edit\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":77,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":77,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { use, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { ChevronLeft, Save, Trash2, User, Home, DollarSign, Calendar } from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { Imovel } from \"@/types\";\r\nimport DeleteConfirmModal from \"@/components/DeleteConfirmModal\";\r\n\r\nexport default function EditPropertyPage({ params }: { params: Promise<{ id: string }> }) {\r\n    const resolvedParams = use(params);\r\n    const { id } = resolvedParams;\r\n\r\n    const router = useRouter();\r\n    const { imoveis, atualizarImovel, deletarImovel } = useApp();\r\n    const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\r\n    const property = imoveis.find((p) => p.id === id) || null;\r\n\r\n    if (!property) {\r\n        return (\r\n            <div className=\"container\" style={{ padding: 'var(--space-xl)', textAlign: 'center' }}>\r\n                <p>Carregando imóvel...</p>\r\n                <Link href=\"/properties\" className=\"btn\" style={{ marginTop: '16px' }}>Voltar</Link>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main style={{ minHeight: '100vh', background: 'var(--color-background)', padding: 'var(--space-md) 0' }}>\r\n            <div className=\"container\" style={{ maxWidth: '800px' }}>\r\n                <header style={{ display: 'flex', alignItems: 'center', marginBottom: 'var(--space-xl)', gap: 'var(--space-sm)' }}>\r\n                    <Link href={`/properties/${id}`} style={{\r\n                        padding: '10px',\r\n                        marginLeft: '-10px',\r\n                        color: 'var(--color-text-secondary)',\r\n                        transition: 'color 0.2s'\r\n                    }} className=\"hover-primary\">\r\n                        <ChevronLeft size={24} />\r\n                    </Link>\r\n                    <h1 style={{ fontSize: '1.75rem', fontWeight: 800, letterSpacing: '-0.03em' }}>Editar Imóvel</h1>\r\n                </header>\r\n\r\n                <PropertyEditForm\r\n                    property={property}\r\n                    onSubmit={atualizarImovel}\r\n                    onDeleteRequest={() => setIsDeleteModalOpen(true)}\r\n                    onSuccess={() => router.push(\"/properties\")}\r\n                />\r\n\r\n                <DeleteConfirmModal\r\n                    isOpen={isDeleteModalOpen}\r\n                    onClose={() => setIsDeleteModalOpen(false)}\r\n                    onConfirm={async () => {\r\n                        await deletarImovel(property.id);\r\n                        router.push(\"/properties\");\r\n                    }}\r\n                    itemName={property.nome}\r\n                    itemType=\"Imóvel\"\r\n                />\r\n            </div>\r\n        </main>\r\n    );\r\n}\r\n\r\nfunction PropertyEditForm({\r\n    property,\r\n    onSubmit,\r\n    onSuccess,\r\n    onDeleteRequest\r\n}: {\r\n    property: Imovel,\r\n    onSubmit: (id: string, updates: Partial<Imovel>) => Promise<void>,\r\n    onSuccess: () => void,\r\n    onDeleteRequest: () => void\r\n}) {\r\n    const router = useRouter();\r\n    const [formData, setFormData] = useState({\r\n        name: property.nome,\r\n        clientName: property.cliente_nome || \"\",\r\n        phone: property.telefone || \"\",\r\n        address: property.endereco || \"\",\r\n        rentAmount: property.valor_aluguel.toString().replace('.', ','),\r\n        paymentDay: (property.dia_pagamento || 10).toString(),\r\n    });\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        await onSubmit(property.id, {\r\n            nome: formData.name,\r\n            cliente_nome: formData.clientName,\r\n            telefone: formData.phone,\r\n            endereco: formData.address,\r\n            valor_aluguel: parseFloat(formData.rentAmount.replace(',', '.')),\r\n            dia_pagamento: parseInt(formData.paymentDay) || 10,\r\n            ativo: property.ativo\r\n        });\r\n        onSuccess();\r\n    };\r\n\r\n    return (\r\n        <form onSubmit={handleSubmit} style={{ display: 'flex', flexDirection: 'column', gap: 'var(--space-lg)' }}>\r\n\r\n            {/* Seção 1: Dados do Cliente */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <User size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Dados do Cliente</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Nome do Inquilino</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.clientName}\r\n                            onChange={(e) => setFormData({ ...formData, clientName: e.target.value })}\r\n                            placeholder=\"Ex: João Silva\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Telefone de Contato</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.phone}\r\n                            onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\r\n                            placeholder=\"(00) 00000-0000\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Seção 2: Detalhes do Imóvel */}\r\n            <section className=\"card\" style={{ padding: 'var(--space-lg)', border: '1px solid var(--color-border)' }}>\r\n                <div style={{ display: 'flex', alignItems: 'center', gap: 'var(--space-sm)', marginBottom: 'var(--space-lg)', borderBottom: '1px solid var(--color-border)', paddingBottom: 'var(--space-sm)' }}>\r\n                    <Home size={18} color=\"var(--color-primary)\" />\r\n                    <h2 style={{ fontSize: '0.9rem', textTransform: 'uppercase', letterSpacing: '0.1em', color: 'var(--color-text-primary)' }}>Informações do Imóvel</h2>\r\n                </div>\r\n\r\n                <div style={{ display: 'grid', gridTemplateColumns: '1fr', gap: 'var(--space-lg)' }}>\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Identificação / Apelido</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.name}\r\n                            onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n                            placeholder=\"Ex: Apartamento 202 - Centro\"\r\n                            required\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"form-group\">\r\n                        <label className=\"label\">Endereço Completo</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"input\"\r\n                            value={formData.address}\r\n                            onChange={(e) => setFormData({ ...formData, address: e.target.value })}\r\n                            placeholder=\"Rua, número, bairro e cidade\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: 'var(--space-lg)' }}>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <DollarSign size={12} /> Valor Mensal\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"text\"\r\n                                className=\"input\"\r\n                                style={{ fontSize: '1.25rem', fontWeight: 700, color: 'var(--color-primary)' }}\r\n                                value={formData.rentAmount}\r\n                                onChange={(e) => setFormData({ ...formData, rentAmount: e.target.value })}\r\n                                placeholder=\"0,00\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label className=\"label\">\r\n                                <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>\r\n                                    <Calendar size={12} /> Dia de Vencimento\r\n                                </div>\r\n                            </label>\r\n                            <input\r\n                                type=\"number\"\r\n                                className=\"input\"\r\n                                min=\"1\"\r\n                                max=\"31\"\r\n                                value={formData.paymentDay}\r\n                                onChange={(e) => setFormData({ ...formData, paymentDay: e.target.value })}\r\n                                placeholder=\"10\"\r\n                                required\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {/* Ações */}\r\n            <div style={{ marginTop: 'var(--space-lg)', display: 'flex', flexDirection: 'column', gap: 'var(--space-md)' }}>\r\n                <button type=\"submit\" className=\"btn btn-success\" style={{ height: '56px', borderRadius: '12px', boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)' }}>\r\n                    <Save size={20} style={{ marginRight: '10px' }} />\r\n                    <span style={{ fontWeight: 700 }}>Salvar Alterações</span>\r\n                </button>\r\n\r\n                <button\r\n                    type=\"button\"\r\n                    onClick={onDeleteRequest}\r\n                    className=\"btn btn-danger-outline\"\r\n                    style={{ height: '52px', borderRadius: '12px', marginTop: '12px' }}\r\n                >\r\n                    <Trash2 size={18} style={{ marginRight: '8px' }} /> Excluir Imóvel\r\n                </button>\r\n            </div>\r\n        </form>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\properties\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\app\\spreadsheet\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\BottomNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\DeleteConfirmModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\LoanCalculatorModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\ServiceWorkerRegister.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'href' is assigned a value but never used.","line":38,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":38,"endColumn":27}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useEffect } from \"react\";\r\n\r\nexport default function ServiceWorkerRegister() {\r\n    useEffect(() => {\r\n        // 1. Register Service Worker with strict scope\r\n        if (\"serviceWorker\" in navigator) {\r\n            // Optional: Unregister old scopes if needed, but registering new one usually handles it.\r\n            // We register immediately as requested.\r\n            navigator.serviceWorker\r\n                .register(\"/sw.js\", { scope: \"/\" })\r\n                .then((registration) => {\r\n                    console.log(\"SW Registered with scope:\", registration.scope);\r\n                })\r\n                .catch((error) => {\r\n                    console.error(\"SW Registration failed:\", error);\r\n                });\r\n        }\r\n\r\n        // 2. iOS / Standalone Mode Handling\r\n        // \"Se estiver rodando como PWA... Ajustar layout\"\r\n        const isStandalone =\r\n            window.matchMedia(\"(display-mode: standalone)\").matches ||\r\n            (window.navigator as Navigator & { standalone?: boolean }).standalone === true;\r\n\r\n        if (isStandalone) {\r\n            // Add a class to html for specific PWA styling if needed\r\n            document.documentElement.classList.add(\"is-pwa\");\r\n\r\n            // Fix for iOS Safari opening links in new window (occasionally happens)\r\n            // We ensure internal links stay in the app.\r\n            // (Next.js Link usually handles this, but this is a safeguard for 'window.location' dependency mentioned)\r\n            document.addEventListener(\"click\", (e: MouseEvent) => {\r\n                const target = (e.target as HTMLElement).closest(\"a\");\r\n                if (!target) return;\r\n\r\n                const href = target.getAttribute(\"href\");\r\n\r\n                // internal link logic safeguard\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    return null;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\SystemHealthCheck.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\SystemHealthModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\components\\ToastProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\context\\AppContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\context\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\hooks\\useFinancialData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\lib\\supabaseAdmin.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\lib\\supabaseClient.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\joaop\\OneDrive\\Área de Trabalho\\teste\\gestao\\src\\utils\\exportUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]